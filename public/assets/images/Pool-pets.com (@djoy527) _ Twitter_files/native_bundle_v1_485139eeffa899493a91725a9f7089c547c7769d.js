/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! matches.js v1.0.3 - Nicolas Gallagher - MIT license */

/*! delegate.js v1.0.2 - Nicolas Gallagher - MIT license */

/*!
 * xdm.js – Nicolas Gallagher – MIT License
 * easyXDM – Copyright(c) 2009-2011, Øyvind Sean Kinsey, oyvind@kinsey.no – MIT License
 */

/*
// Copyright 2012 Twitter, Inc
// http://www.apache.org/licenses/LICENSE-2.0

// TwitterCLDR (JavaScript) v2.1.0
// Authors:     Cameron Dutro [@camertron]
                Kirill Lashuk [@KL_7]
                portions by Sven Fuchs [@svenfuchs]
// Homepage:    https://twitter.com
// Description: Provides date, time, number, and list formatting functionality for various Twitter-supported locales in Javascript.
*/

!function(){var e,t,r;!function(n){function o(e,t){return C.call(e,t)}function i(e,t){var r,n,o,i,a,c,u,s,l,d,f=t&&t.split("/"),_=v.map,p=_&&_["*"]||{};if(e&&"."===e.charAt(0))if(t){for(f=f.slice(0,f.length-1),e=f.concat(e.split("/")),s=0;s<e.length;s+=1)if(d=e[s],"."===d)e.splice(s,1),s-=1;else if(".."===d){if(1===s&&(".."===e[2]||".."===e[0]))break;s>0&&(e.splice(s-1,2),s-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||p)&&_){for(r=e.split("/"),s=r.length;s>0;s-=1){if(n=r.slice(0,s).join("/"),f)for(l=f.length;l>0;l-=1)if(o=_[f.slice(0,l).join("/")],o&&(o=o[n])){i=o,a=s;break}if(i)break;!c&&p&&p[n]&&(c=p[n],u=s)}!i&&c&&(i=c,a=u),i&&(r.splice(0,a,i),e=r.join("/"))}return e}function a(e,t){return function(){return _.apply(n,y.call(arguments,0).concat([e,t]))}}function c(e){return function(t){return i(t,e)}}function u(e){return function(t){h[e]=t}}function s(e){if(o(g,e)){var t=g[e];delete g[e],E[e]=!0,f.apply(n,t)}if(!o(h,e)&&!o(E,e))throw new Error("No "+e);return h[e]}function l(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function d(e){return function(){return v&&v.config&&v.config[e]||{}}}var f,_,p,m,h={},g={},v={},E={},C=Object.prototype.hasOwnProperty,y=[].slice;p=function(e,t){var r,n=l(e),o=n[0];return e=n[1],o&&(o=i(o,t),r=s(o)),o?e=r&&r.normalize?r.normalize(e,c(t)):i(e,t):(e=i(e,t),n=l(e),o=n[0],e=n[1],o&&(r=s(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},m={require:function(e){return a(e)},exports:function(e){var t=h[e];return"undefined"!=typeof t?t:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:d(e)}}},f=function(e,t,r,i){var c,l,d,f,_,v,C=[];if(i=i||e,"function"==typeof r){for(t=!t.length&&r.length?["require","exports","module"]:t,_=0;_<t.length;_+=1)if(f=p(t[_],i),l=f.f,"require"===l)C[_]=m.require(e);else if("exports"===l)C[_]=m.exports(e),v=!0;else if("module"===l)c=C[_]=m.module(e);else if(o(h,l)||o(g,l)||o(E,l))C[_]=s(l);else{if(!f.p)throw new Error(e+" missing "+l);f.p.load(f.n,a(i,!0),u(l),{}),C[_]=h[l]}d=r.apply(h[e],C),e&&(c&&c.exports!==n&&c.exports!==h[e]?h[e]=c.exports:d===n&&v||(h[e]=d))}else e&&(h[e]=r)},e=t=_=function(e,t,r,o,i){return"string"==typeof e?m[e]?m[e](t):s(p(e,t).f):(e.splice||(v=e,t.splice?(e=t,t=r,r=null):e=n),t=t||function(){},"function"==typeof r&&(r=o,o=i),o?f(n,e,t,r):setTimeout(function(){f(n,e,t,r)},4),_)},_.config=function(e){return v=e,v.deps&&_(v.deps,v.callback),_},r=function(e,t,r){t.splice||(r=t,t=[]),o(h,e)||o(g,e)||(g[e]=[e,t,r])},r.amd={jQuery:!0}}(),r("almondLib",function(){}),function(e){function t(e,t){var r,n,a=e.parentNode;if(a||i||(a=document.createDocumentFragment(),a.appendChild(e)),o)return o.call(e,t);for(r=a.querySelectorAll(t),n=r.length;n--;)if(r[n]===e)return!0;return!1}var n=Element.prototype,o=n.matches||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector,i=function(){return o?o.call(document.createElement("a"),"a"):!1}();"object"==typeof exports?module.exports=t:"function"==typeof r&&r.amd?r("matches",[],function(){return t}):e.matches=t}(this),function(e){function n(e){function t(e){if(!n(e))throw new Error("delegate(): The argument must be an Element or Document Node");return o=e,t}function r(t,r,n){for(;r&&r!==t;){if(e(r,n))return r;r=r.parentElement}return null}function n(e){return e&&e.nodeName&&(3===e.nodeType||9===e.nodeType)?!0:!1}var o;return t.on=function(e,n,i,a,c){function u(a){(a.delegateTarget=r(o,a.target,n))&&(c===!0&&t(o).off(e,u),i.call(o,a))}return i._delegateWrapper=u,o.addEventListener(e,u,a||!1),i},t.once=function(e,r,n,o){t.on(e,r,n,o,!0)},t.off=function(e,t,r){t._delegateWrapper&&(t=t._delegateWrapper),o.removeEventListener(e,t,r||!1)},t}"object"==typeof exports?module.exports=n(t("matches")):"function"==typeof r&&r.amd?r("delegate",["matches"],n):e.delegate=n(e.matches)}(this),r("common/xhrhelper",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(){var e={httpMethodTypes:{GET:"get",POST:"post",PUT:"put",DELETE:"delete"},sendRequest:function(e,t,r,n){var o=new XMLHttpRequest;o.addEventListener("load",r.onSuccess,!0),o.addEventListener("error",r.onFailure,!0),o.addEventListener("abort",r.onFailure,!0),o.open(e,t,"boolean"==typeof r.async?r.async:!0),void 0!==n&&(o._requestId=n),"boolean"==typeof r.withCredentials&&(o.withCredentials=r.withCredentials);for(var i in r.headers)r.headers.hasOwnProperty(i)&&o.setRequestHeader(i,r.headers[i]);r.body?o.send(r.body):o.send()},get:function(t,r,n){e.sendRequest(e.httpMethodTypes.GET,t,r,n)},post:function(t,r,n){e.sendRequest(e.httpMethodTypes.POST,t,r,n)}};return e}}),r("../native/js/form-handler",["require","exports","module","delegate","common/xhrhelper"],function(e,t,r){var n=e("delegate"),o=e("common/xhrhelper");r.exports=function(){var e={xhrHelper:new o,selectors:{FORM:".js-form",CALL_TO_ACTION:".js-submitForm",ROOT_TOGGLE_ELEMENT:".hasToggleElements",CARD_IFRAME:".js-macaw-cards-iframe-container iframe",SUCCESS_MESSAGE:".PromotionCardFull--SuccessMessage",INPUT_FIELD:".PromotionCardFull--Input",ZIPCODE_STATUS:".js-zipcodeStatus",ZIPCODE_INPUT:".js-zipcodeInput"},classes:{SUCCESS_ELEMENTS:"successElements",ERROR_ELEMENTS:"errorElements"},resizeEvent:null,resizeEventObject:null,init:function(){n(document).on("click",e.selectors.CALL_TO_ACTION,e.submitForm),n(document).on("change",e.selectors.INPUT_FIELD,e.validateForm),n(document).on("keyup",e.selectors.INPUT_FIELD,e.validateForm),document.createEvent?(e.resizeEvent=document.createEvent("Event"),e.resizeEvent.initEvent("resize",!0,!0)):document.createEventObject&&(e.resizeEventObject=document.createEventObject("Event"),e.resizeEventObject.eventType="resize")},teardown:function(){n(document).off("click",e.submitForm),n(document).off("change",e.validateForm),n(document).off("keyup",e.validateForm)},setAttributes:function(e,t,r){for(var n=document.querySelectorAll(e),o=0;o<n.length;o++)n[o].setAttribute(t,r)},validateForm:function(t){var r=!0,n=document.querySelector(e.selectors.ZIPCODE_INPUT);if(n){document.querySelectorAll(e.selectors.ZIPCODE_STATUS);n.value&&n.value.trim()?e.setAttributes(e.selectors.ZIPCODE_STATUS,"data-status","ok"):(e.setAttributes(e.selectors.ZIPCODE_STATUS,"data-status","error"),r=!1)}return r},submitForm:function(t){t.preventDefault();var r=document.querySelector(e.selectors.FORM);if(r&&e.validateForm()){var n=e.getFormData(r);e.xhrHelper.sendRequest(e.xhrHelper.httpMethodTypes.POST,r.action,{onSuccess:e.handleSuccessResponse,onFailure:e.handleErrorResponse,body:n,headers:null,withCredentials:!0})}},getFormData:function(e){var t,r,n=new FormData,o=e.querySelectorAll("input");for(t=0;r=o[t];t++)n.append(r.name,r.value);return n},handleSuccessResponse:function(t){try{var r=JSON.parse(t.target.responseText).data;if(r.display){document.querySelector(e.selectors.SUCCESS_MESSAGE).innerHTML=r.display;var n=document.querySelectorAll(e.selectors.SUCCESS_MESSAGE+" a");for(i=0;el=n[i];i++)e.toggleClassOn(el,"js-openLink"),el.setAttribute("data-pe-name","card_url_click")}}catch(o){}e.handleResponse(e.classes.SUCCESS_ELEMENTS,e.classes.ERROR_ELEMENTS)},handleErrorResponse:function(t){e.handleResponse(e.classes.ERROR_ELEMENTS,null)},handleResponse:function(t,r){var n=document.querySelector(e.selectors.ROOT_TOGGLE_ELEMENT);n&&(t&&e.toggleClassOn(n,t),r&&e.toggleClassOff(n,r),e.resizeIframe())},toggleClassOff:function(t,r){t.className=t.className.replace(e.getClassStringRegEx(r),"")},toggleClassOn:function(t,r){t.className.match(e.getClassStringRegEx(r))||(t.className+=" "+r)},getClassStringRegEx:function(e){return new RegExp("(?:^|\\s)"+e+"(?!\\S)","g")},resizeIframe:function(){e.resizeEvent?window.dispatchEvent(e.resizeEvent):e.resizeEventObject&&window.fireEvent("on"+e.resizeEventObject.eventType,e.resizeEventObject)}};return e.init(),e}}),function(e){"use strict";function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){return"undefined"==typeof e}function o(t){return e.xdm=I,C=t,C&&(w="xdm_"+C.replace(".","_")+"_"),y}function i(e){if(!e)throw new Error("url is undefined or empty");if(/^file/.test(e))throw new Error("The file:// protocol is not supported");var t=e.toLowerCase().match(g);if(t){var r=t[2],n=t[3],o=t[4]||"";return("http:"===r&&":80"===o||"https:"===r&&":443"===o)&&(o=""),r+"//"+n+o}return e}function a(e){if(!e)throw new Error("url is undefined or empty");if(e=e.replace(E,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":location.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=location.protocol+"//"+location.host+t+e}for(;v.test(e);)e=e.replace(v,"");return e}function c(e,t){if(!t)throw new Error("parameters is undefined or null");var r=e.indexOf("#"),n=[];for(var o in t)t.hasOwnProperty(o)&&n.push(o+"="+encodeURIComponent(t[o]));return e+(-1===r?"#":"&")+n.join("&")}function u(e,t,r){var n;for(var o in t)t.hasOwnProperty(o)&&(o in e?(n=t[o],"object"==typeof n?u(e[o],n,r):r||(e[o]=t[o])):e[o]=t[o]);return e}function s(e){var t=p.cloneNode(!1);if(u(e.props,{frameBorder:0,allowTRansparency:!0,scrolling:"no",width:"100%",src:c(e.remote,{xdm_e:i(location.href),xdm_c:e.channel,xdm_p:1}),name:w+e.channel+"_provider",style:{margin:0,padding:0,border:0}}),t.id=e.props.name,delete e.props.name,!e.container)throw new Error('xdm.Rpc() configuration object missing a DOM "container" property');return u(t,e.props),e.container.appendChild(t),e.onLoad&&T(t,"load",e.onLoad),e.html&&(t.contentWindow.document.open(),t.contentWindow.document.write(e.html),t.contentWindow.document.close()),e.iframe=t,t}function l(e,t){"string"==typeof e&&(e=[e]);for(var r,n=e.length;n--;)if(r=e[n],r=new RegExp("^"===r.substr(0,1)?r:"^"+r.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),r.test(t))return!0;return!1}function d(e){var t;if(e.isHost=e.isHost||n(D.xdm_p),e.props=e.props||{},e.isHost)e.remote=a(e.remote),e.channel=e.channel||"default"+m++;else if(e.channel=D.xdm_c.replace(/["'<>\\]/g,""),e.remote=D.xdm_e.replace(/["'<>\\]/g,""),e.acl&&!l(e.acl,e.remote))throw new Error("Access denied for "+e.remote);return t=[new y.stack.PostMessageTransport(e)],t.push(new y.stack.QueueBehavior(!0)),t}function f(e){var t,r,n=e.length,o={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(r=0;n>r;r++)t=e[r],u(t,o,!0),0!==r&&(t.down=e[r-1]),r!==n-1&&(t.up=e[r+1]);return t}function _(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var p=document.createElement("IFRAME"),m=Math.floor(1e4*Math.random()),h=Function.prototype,g=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,v=/[\-\w]+\/\.\.\//,E=/([^:])\/\//g,C="",y={},I=e.xdm,w="xdm_",D=function(e){e=e.substring(1,e.length).split("&");for(var t,r={},n=e.length;n--;)t=e[n].split("="),r[t[0]]=decodeURIComponent(t[1]);return r}(location.hash),T=function(){return e.addEventListener?function(e,t,r){e.addEventListener(t,r,!1)}:function(e,t,r){e.attachEvent("on"+t,r)}}(),P=function(){return e.removeEventListener?function(e,t,r){e.removeEventListener(t,r,!1)}:function(e,t,r){e.detachEvent("on"+t,r)}}();u(y,{version:"1.0.0",query:D,stack:{},noConflict:o}),y.Rpc=function(e,t){var r;if(t.local)for(var n in t.local)t.local.hasOwnProperty(n)&&(r=t.local[n],"function"==typeof r&&(t.local[n]={method:r}));var o=f(d(e).concat([new y.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=i(e.remote),this.destroy=function(){o.destroy()},o.init(),this.iframe=e.iframe},y.stack.PostMessageTransport=function(t){function r(e){var r=i(e.origin),o="string"==typeof e.data;r===c&&o&&e.data.substring(0,t.channel.length+1)===t.channel+" "&&n.up.incoming(e.data.substring(t.channel.length+1),r)}var n,o,a,c;return n={outgoing:function(e,r,n){a.postMessage(t.channel+" "+e,r||c),n&&n()},destroy:function(){P(e,"message",r),o&&(a=null,o.parentNode.removeChild(o),o=null)},init:function(){if(c=i(t.remote),t.isHost){var u=function(i){i.data===t.channel+"-ready"&&(a="postMessage"in o.contentWindow?o.contentWindow:o.contentWindow.document,P(e,"message",u),T(e,"message",r),setTimeout(function(){n.up.callback(!0)},0))};T(e,"message",u),o=s(t)}else T(e,"message",r),a="postMessage"in e.parent?e.parent:e.parent.document,a.postMessage(t.channel+"-ready",c),setTimeout(function(){n.up.callback(!0)},0)}}},y.stack.QueueBehavior=function(e){function t(){var a;return e===!0&&0===o.length?void _(r):void(i||0===o.length||n||(i=!0,a=o.shift(),r.down.outgoing(a.data,a.origin,function(e){i=!1,a.callback&&setTimeout(function(){a.callback(e)},0),t()})))}var r,n,o=[],i=!0;return r={init:function(){r.down.init()},callback:function(e){i=!1;var n=r.up;t(),n.callback(e)},incoming:function(e,t){r.up.incoming(e,t)},outgoing:function(e,r,n){o.push({data:e,origin:r,callback:n}),t()},destroy:function(){n=!0,r.down.destroy()}}},y.stack.RpcBehavior=function(e,r){function o(e){e.jsonrpc="2.0",c.down.outgoing(JSON.stringify(e))}function i(e,t){var r=Array.prototype.slice;return function(){var n,i=arguments.length,a={method:t};i>0&&"function"==typeof arguments[i-1]?(i>1&&"function"==typeof arguments[i-2]?(n={success:arguments[i-2],error:arguments[i-1]},a.params=r.call(arguments,0,i-2)):(n={success:arguments[i-1]},a.params=r.call(arguments,0,i-1)),s[""+ ++u]=n,a.id=u):a.params=r.call(arguments,0),e.namedParams&&1===a.params.length&&(a.params=a.params[0]),o(a)}}function a(e,r,i,a){if(!i)return void(r&&o({id:r,error:{code:-32601,message:"Procedure not found."}}));var c,u;r?(c=function(e){c=h,o({id:r,result:e})},u=function(e,t){u=h;var n={id:r,error:{code:-32099,message:e}};t&&(n.error.data=t),o(n)}):c=u=h,t(a)||(a=[a]);try{var s=i.method.apply(i.scope,a.concat([c,u]));n(s)||c(s)}catch(l){u(l.message)}}var c,u=0,s={};return c={incoming:function(e,t){var n,i=JSON.parse(e);i.method?r.handle?r.handle(i,o):a(i.method,i.id,r.local[i.method],i.params):(n=s[i.id],i.error&&n.error?n.error(i.error):n.success&&n.success(i.result),delete s[i.id])},init:function(){if(r.remote)for(var t in r.remote)r.remote.hasOwnProperty(t)&&(e[t]=i(r.remote[t],t));c.down.init()},destroy:function(){for(var t in r.remote)r.remote.hasOwnProperty(t)&&e.hasOwnProperty(t)&&delete e[t];c.down.destroy()}}},"object"==typeof exports?module.exports=y:"function"==typeof provide?provide(y):"function"==typeof r&&r.amd?r("xdm",[],function(){return y}):e.xdm=y}(window),r("common/logger",["require","exports","module"],function(e,t,r){"use strict";function n(e){return function(){if(window.DEBUG){var t=Array.prototype.slice.apply(arguments);t.unshift(e),console.log.apply(console,t)}}}r.exports=n}),r("common/utils",["require","exports","module","common/logger"],function(e,t,r){"use strict";var n=e("common/logger")("[UTILS]"),o={mergeObjects:function(e,t){function r(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}var n={};return r(n,e),r(n,t),n},getConfigFromJsonIn:function(e){var t,r=document.getElementById(e),o=null;if(!r)return n(["Element with id",e,"not found"].join(" ")),o;t=r.innerHTML;try{o=JSON.parse(t)}catch(i){n(["Error while parsing json in element",e].join(" "),i)}return o},isEmpty:function(e){return!o.isDefined(e)||"string"==typeof e&&0===e.length},isDefined:function(e){return"undefined"!=typeof e&&null!==e},isObject:function(e){return o.isDefined(e)&&"object"==typeof e},toArray:function(e){return Array.prototype.slice.call(e,0)},escapeHtml:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},decodeHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0].nodeValue},trigger:function(e,t){var r=new Event(t);e.dispatchEvent(r)},getFollowElements:function(e){var t,r=e&&e.target;if(r){for(;!r.dataset.userId&&r.parentElement;)r=r.parentElement;return t=r.dataset.userId,o.fetchTargetElement("data-user-id",t)}return[]},fetchTargetElement:function(e,t){var r="*["+e+'="'+t+'"]';return o.toArray(document.querySelectorAll(r))},createUrl:function(e,t){var r=e;r+=-1!==r.indexOf("?")?"&":"?";for(var n in t)r=r+encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&";return r.substr(0,r.length-1)},getTarget:function(e){return e.target},extend:function(e){var t,r,n=Array.prototype.slice.call(arguments,1);for(t in n){var o=n[t];for(r in o)void 0!==o[r]&&(e[r]=o[r])}return e}};r.exports=o}),r("common/video-interface-manager",["require","exports","module","delegate","xdm","common/utils"],function(e,t,r){"use strict";function n(){var e=d.getConfigFromJsonIn("video-config"),t="";return"undefined"!=typeof e&&null!==e&&(t=d.createUrl(e.video_player_url,e.params)),t}function o(){return document.querySelectorAll(".VideoContainer")}function i(){var e=document.getElementById("ExternalIframeContainer");return e&&e.className.match(/\bAmplifyContainer\b/)?e:void 0}function a(e,t,r,n){return n=n||{},function(o){var i=Array.prototype.slice.call(arguments),a=i.length-2,c=i.length-1,u=i[a],s=i[c],l=function(e){if("requestPlayerConfig"===o){var n,e=e||{};try{n=JSON.parse(t.getAttribute("data-player-config"))}catch(i){n={}}return d.extend(e,r?d.mergeObjects(n,{scribeParams:r}):n)}return e};i[a]=function(e){u(l(e))},i[c]=function(){"requestPlayerConfig"===o?u(l()):s(l())},o in n&&"function"==typeof n[o]&&n[o](),e.callVideoHostMethod.apply(e,i)}}function c(e,t,r,n,o,i){var c=new l.Rpc({remote:t,container:e,isHost:!0,onReady:function(){n&&(c.play(),c.mute())}},{local:{callVideoHostMethod:a(r,e,o,i)},remote:{autoPlayPreview:{},autoPlayPreviewStop:{},callMethodByName:{},getMediaStatus:{},mute:{},play:{}}});return c.iframe.setAttribute("allowfullscreen",""),c}function u(e,t,r,i){for(var a,u,s,l,f=o(),_=0;_<f.length;_++)a=f[_],u={vmap_url:a.getAttribute("data-src"),image_src:a.getAttribute("data-thumbnail"),content_id:a.getAttribute("data-content-id"),type:a.getAttribute("data-type")},l=d.createUrl(n(),u),s=c(a,l,e,t,r,i),e.attachVideoInterface(s)}function s(e,t,r,n){var o,a,u=i();u&&(o=u.getAttribute("data-player-url"),a=c(u,o,e,t,r,n),e.attachVideoInterface(a))}var l=(e("delegate"),e("xdm")),d=e("common/utils"),f={init:function(e,t,r,n){u(e,t,r,n),s(e,t,r,n)},isSupported:function(){var e=o(),t=i();return e.length>0||"undefined"!=typeof t},getCallVideoHostMethod:a};r.exports=f}),r("../native/js/flex-embed",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(){var e,t,r=document.getElementById("ExternalIframeContainer");r&&(e=r.getAttribute("data-iframe-aspect-ratio-numerator"),t=r.getAttribute("data-iframe-aspect-ratio-denominator"),r.style.paddingBottom=100*t/e+"%")}}),r("../native/js/api-request",["require","exports","module","common/xhrhelper"],function(e,t,r){"use strict";var n=e("common/xhrhelper");r.exports=function(e,t){var r=new n,o=function(){this.status>=200&&this.status<=299?e(this,this._requestId):t(this,this._requestId)},i=function(){t(this,this._requestId)},a={getRequest:function(e,t,n,a){r.get(t,{onSuccess:o,onFailure:i,body:n,withCredentials:a},e)},postRequest:function(e,t,n,a){r.post(t,{onSuccess:o,onFailure:i,body:n,withCredentials:a},e)}};return a}}),r("../native/js/card-data-broker",["require","exports","module","./api-request"],function(e,t,r){"use strict";var n=e("./api-request");r.exports=function(){var e={GET:"get",POST:"post"},t={_apiRequest:null,_requestUrl:null,_onDataUpdate:null,_onRequestError:null,_lastRequestIndex:0,_activeRequests:{},_pendingRequests:{},_refreshInterval:null,_intervalId:null,_originalData:null,init:function(e){t._apiRequest=new n(t._onSuccess,t._onFailure),t._requestUrl=t._buildRequestUrl(e),t._originalData=e.originalData,t._refreshInterval=0,e.refreshInterval>0&&(t._refreshInterval=1e3*e.refreshInterval)},register:function(e,r){t._onDataUpdate=e,t._onRequestError=r,null!==t._intervalId&&(clearInterval(t._intervalId),t._intervalId=null),t._refreshInterval>0&&(t._intervalId=setInterval(t._onInterval,t._refreshInterval))},unregister:function(){null!==t._intervalId&&(clearInterval(t._intervalId),t._intervalId=null),t.cancelAll(),t._onDataUpdate=null,t._onRequestError=null},doRead:function(e,r){if(t._requestUrl){var n=t._genNewId();return t._doReadInternal(n,e,r)}},doWrite:function(e){if(t._requestUrl){var r=t._genNewId();return t._doWriteInternal(r,e)}},cancel:function(e){delete t._activeRequests[e],delete t._pendingRequests[e]},cancelAll:function(){t._activeRequests={},t._pendingRequests={}},_genNewId:function(){return t._lastRequestIndex=t._lastRequestIndex+1,t._lastRequestIndex},_buildRequestUrl:function(e){var r="/i/cards/api/v1.json",n=window.location.host,o=window.location.protocol;return void 0!==e.tweetId&&void 0!=e.cardName&&void 0!==e.token&&void 0!==e.forward&&void 0!==e.uri?o+"//"+n+r+"?tweet_id="+e.tweetId+"&card_name="+t._escapeString(e.cardName)+"&authenticity_token="+e.token+"&forward="+e.forward.toString()+"&capi_uri="+t._escapeString(e.uri):void 0},_findAndResetRequest:function(e){var r=t._activeRequests[e];return delete t._activeRequests[e],r&&r.repeat&&t._intervalId&&(t._pendingRequests[e]=r),r},_escapeString:function(e){return encodeURIComponent(e)},_onInterval:function(){for(var e in t._pendingRequests){var r=t._pendingRequests[e];t._doReadInternal(e,r.request,r.repeat)}t._pendingRequests={}},_doReadInternal:function(r,n,o){var i=JSON.stringify(n),a=t._requestUrl+"&body="+t._escapeString(i);return t._activeRequests[r]={request:n,method:e.GET,repeat:o===!0},t._apiRequest.getRequest(r,a,i,!0),r},_doWriteInternal:function(r,n){var o=JSON.stringify(n);return t._activeRequests[r]={request:n,method:e.POST,repeat:!1},t._apiRequest.postRequest(r,t._requestUrl,o,!0),r},_onSuccess:function(e,r){var n=t._findAndResetRequest(r);if(void 0!==n&&"function"==typeof t._onDataUpdate){var o;try{o=JSON.parse(e.response)}catch(i){}o?"successful"in o?o.successful&&o.response?t._onDataUpdate(t._originalData,o.response,r):t._onRequestError(t._originalData,{},r):t._onDataUpdate(t._originalData,o,r):t._onRequestError(t._originalData,{},r)}},_onFailure:function(e,r){var n=t._findAndResetRequest(r);void 0!==n&&"function"==typeof t._onRequestError&&t._onRequestError(t._originalData,e,r)}};return t}}),r("../native/js/card-helper",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(){var e={showElement:function(t){var r=e.queryElement(t);r&&(r.style.display="block")},hideElement:function(t){var r=e.queryElement(t);r&&(r.style.display="none")},setContent:function(t,r){var n=e.queryElement(t);n&&(n.innerHTML=r)},queryElement:function(e){var t=document.querySelector(e);return t},queryElements:function(e){return document.querySelectorAll(e)}};return e}}),r("../native/js/card-page-controller",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(){var e={_currentPage:null,_loadPage:function(e){e&&"function"==typeof e.load&&e.load()},_unloadPage:function(e){e&&"function"==typeof e.unload&&e.unload()},init:function(t){e._loadPage(t),e._currentPage=t},switchToPage:function(t){return t!==e.currentPage?(e._unloadPage(e._currentPage),e._loadPage(t),e._currentPage=t,e._currentPage):void 0},getCurrentPage:function(){return e._currentPage}};return e}}),r("../native/js/poll_shared/card-poll",["require","exports","module","delegate","./../card-data-broker","./../card-helper","./../card-page-controller"],function(e,t,r){"use strict";var n=(e("delegate"),e("./../card-data-broker"),e("./../card-helper"));e("./../card-page-controller");r.exports=function(e){var t={attribute:{POLL_OPTION:"data-poll-option",POLL_COMPLETED:"data-poll-completed"},selector:{PAGE_RESULT:".PollCardShared-resultPage",PAGE_VOTING:".PollCardShared-votingPage",CONTAINER:".PollCardShared"},cardHelper:new n,pollContainer:null,pollOptions:null,twitterInterface:e,init:function(){t.pollContainer=document.querySelector(t.selector.CONTAINER),t.pollOptions=t.pollContainer.querySelectorAll(t.selector.PAGE_VOTING+" ["+t.attribute.POLL_OPTION+"]");for(var e,r=0;e=t.pollOptions[r];r++)e.addEventListener("click",t.handleOptionClick);t.pollContainer&&!t.pollContainer.getAttribute(t.attribute.POLL_COMPLETED)&&t.cardHelper.hideElement(t.selector.PAGE_RESULT)},handleOptionClick:function(){var e=this.getAttribute(t.attribute.POLL_OPTION);e&&e.length<140&&(e+=" "),t.twitterInterface.composeTweet({tweetText:e||"",scribeData:t.twitterInterface.config.scribeData});for(var r,n=0;r=t.pollOptions[n];n++)r.removeEventListener("click",t.handleOptionClick);setTimeout(function(){t.cardHelper.showElement(t.selector.PAGE_RESULT),t.cardHelper.hideElement(t.selector.PAGE_VOTING),t.twitterInterface.handleResize()},500)}};return t}}),r("../native/js/ext/parameterize",["require","exports","module"],function(e,t,r){var n=/\{\{(.+?)\}\}/g;r.exports=function(e,t,r){return t?e.replace(n,function(e,n){if(n){if(t[n])return t[n];if(r)throw new Error("Cannot parameterize string, no replacement found for "+n);return""}return e}):e}}),r("../native/js/ext/i18n",["require","exports","module","./parameterize"],function(e,t,r){r.exports=e("./parameterize")}),r("../native/js/utils/number-helper",["require","exports","module"],function(e,t,r){"use strict";var n=r.exports={isNaN:Number.isNaN||function(e){return"number"==typeof e&&isNaN(e)},parseInt:function(e){var t=parseInt(e);return n.isNaN(t)&&(t=0),t}}}),r("../native/js/utils/emoji-wrap",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e){var t=["[\\uE000-\\uF8FF]","\\uD7C9[\\uDCC2-\\uDFB0]","\\uD7C9[\\uDF02-\\uDFB0]","\\uD83C[\\uDE01-\\uDE51]","\\uD83C[\\uDF00-\\uDFFF]","\\uD83D[\\uDC00-\\uDE4F]","\\uD83D[\\uDE80-\\uDEC0]","\\uD83C[\\uDDE0-\\uDDFF]\\uD83C[\\uDDE0-\\uDDFF]","[\\u0030-\\u0039]\\u20E3","\\u0023\\u20E3"],r=new RegExp(t.join("|"),"g"),n='<span class="is-emojiCharacter">$&</span>';return e.replace(r,n)}}),r("../native/js/ext/twitter_cldr/ar",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!0,n.PluralRules=function(){function e(){}return e.rules={keys:["zero","one","two","few","many","other"],rule:function(e){return function(){return 0==e?"zero":function(){return 1==e?"one":function(){return 2==e?"two":function(){return[3,4,5,6,7,8,9,10].indexOf(e%100)>=0?"few":function(){return[11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99].indexOf(e%100)>=0?"many":"other"}()}()}()}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/ko",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/de",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/fr",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return e>=0&&2>=e&&2!=e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/it",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/es",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/ja",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/pt",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/ru",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","few","many","other"],rule:function(e){return function(){return e%10==1&&e%100!=11?"one":function(){return[2,3,4].indexOf(e%10)>=0&&!([12,13,14].indexOf(e%100)>=0)?"few":function(){return e%10==0||[5,6,7,8,9].indexOf(e%10)>=0||[11,12,13,14].indexOf(e%100)>=0?"many":"other"}()}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/id",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/tr",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/he",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!0,n.PluralRules=function(){function e(){}return e.rules={keys:["one","two","many","other"],rule:function(e){return function(){return 1==e?"one":function(){return 2==e?"two":function(){return 0!=e?"many":"other"}()}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/da",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/no",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){
return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/nl",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/pl",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","few","many","other"],rule:function(e){return function(){return 1==e?"one":function(){return[2,3,4].indexOf(e%10)>=0&&!([12,13,14].indexOf(e%100)>=0)?"few":function(){return 1!=e&&[0,1].indexOf(e%10)>=0||[5,6,7,8,9].indexOf(e%10)>=0||[12,13,14].indexOf(e%100)>=0?"many":"other"}()}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/sv",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/zh-cn",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/zh-tw",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/fil",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return[0,1].indexOf(e)>=0?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/msa",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/hi",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return[0,1].indexOf(e)>=0?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/hu",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/fi",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/ur",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!0,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/th",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/fa",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!0,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/cs",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","few","other"],rule:function(e){return function(){return 1==e?"one":function(){return[2,3,4].indexOf(e)>=0?"few":"other"}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/uk",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","few","many","other"],rule:function(e){return function(){return e%10==1&&e%100!=11?"one":function(){return[2,3,4].indexOf(e%10)>=0&&!([12,13,14].indexOf(e%100)>=0)?"few":function(){return e%10==0||[5,6,7,8,9].indexOf(e%10)>=0||[11,12,13,14].indexOf(e%100)>=0?"many":"other"}()}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/vi",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["other"],rule:function(e){return"other"}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/ro",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","few","other"],rule:function(e){return function(){return 1==e?"one":function(){return 0==e?"few":"other"}()}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/bn",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/ta",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/el",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr/en",["require","exports","module"],function(e,t,r){"use strict";var n={};n.is_rtl=!1,n.PluralRules=function(){function e(){}return e.rules={keys:["one","other"],rule:function(e){return function(){return 1==e?"one":"other"}()}},e.all=function(){return this.rules.keys},e.rule_for=function(e){try{return this.rules.rule(e)}catch(t){return"other"}},e},r.exports=function(){return n}}),r("../native/js/ext/twitter_cldr",["require","exports","module","./twitter_cldr/ar","./twitter_cldr/ko","./twitter_cldr/de","./twitter_cldr/fr","./twitter_cldr/it","./twitter_cldr/es","./twitter_cldr/ja","./twitter_cldr/pt","./twitter_cldr/ru","./twitter_cldr/id","./twitter_cldr/tr","./twitter_cldr/he","./twitter_cldr/da","./twitter_cldr/no","./twitter_cldr/nl","./twitter_cldr/pl","./twitter_cldr/sv","./twitter_cldr/zh-cn","./twitter_cldr/zh-tw","./twitter_cldr/fil","./twitter_cldr/msa","./twitter_cldr/hi","./twitter_cldr/hu","./twitter_cldr/fi","./twitter_cldr/ar","./twitter_cldr/ur","./twitter_cldr/th","./twitter_cldr/fa","./twitter_cldr/cs","./twitter_cldr/uk","./twitter_cldr/vi","./twitter_cldr/ro","./twitter_cldr/bn","./twitter_cldr/ta","./twitter_cldr/el","./twitter_cldr/en"],function(e,t,r){"use strict";r.exports=function(t){var r;switch(t){case"en":r=e("./twitter_cldr/ar");break;case"ko":r=e("./twitter_cldr/ko");break;case"de":r=e("./twitter_cldr/de");break;case"fr":r=e("./twitter_cldr/fr");break;case"it":r=e("./twitter_cldr/it");break;case"es":r=e("./twitter_cldr/es");break;case"ja":r=e("./twitter_cldr/ja");break;case"pt":r=e("./twitter_cldr/pt");break;case"ru":r=e("./twitter_cldr/ru");break;case"id":r=e("./twitter_cldr/id");break;case"tr":r=e("./twitter_cldr/tr");break;case"he":r=e("./twitter_cldr/he");break;case"da":r=e("./twitter_cldr/da");break;case"no":r=e("./twitter_cldr/no");break;case"nl":r=e("./twitter_cldr/nl");break;case"pl":r=e("./twitter_cldr/pl");break;case"sv":r=e("./twitter_cldr/sv");break;case"zh-cn":r=e("./twitter_cldr/zh-cn");break;case"zh-tw":r=e("./twitter_cldr/zh-tw");break;case"fil":r=e("./twitter_cldr/fil");break;case"msa":r=e("./twitter_cldr/msa");break;case"hi":r=e("./twitter_cldr/hi");break;case"hu":r=e("./twitter_cldr/hu");break;case"fi":r=e("./twitter_cldr/fi");break;case"ar":r=e("./twitter_cldr/ar");break;case"ur":r=e("./twitter_cldr/ur");break;case"th":r=e("./twitter_cldr/th");break;case"fa":r=e("./twitter_cldr/fa");break;case"cs":r=e("./twitter_cldr/cs");break;case"uk":r=e("./twitter_cldr/uk");break;case"vi":r=e("./twitter_cldr/vi");break;case"ro":r=e("./twitter_cldr/ro");break;case"bn":r=e("./twitter_cldr/bn");break;case"ta":r=e("./twitter_cldr/ta");break;case"el":r=e("./twitter_cldr/el");break;default:r=e("./twitter_cldr/en")}return r()}}),r("../native/js/utils/text-pluralize",["require","exports","module","./../ext/twitter_cldr"],function(e,t,r){"use strict";var n=e("./../ext/twitter_cldr");r.exports=function(e){var t=n(e),r=new t.PluralRules,o=function(e,t,n,o){var i=r.rule_for(t),a=function(e){var t="{{#"+e+"}}(.*){{/"+e+"}}";return new RegExp(t)},c=function(e){var t="{{"+e+"}}";return new RegExp(t,"g")},u=e+"_"+i,s=a(u),l=s.exec(o);null===l&&(u=e+"_other",s=a(u),l=s.exec(o));var d="";null!==l&&(d=l[1]);var f="";if(void 0!==d){var s=c(e);f=d.replace(s,n)}return f};return o}}),r("../native/js/consumer-poll/pollxchoice",["require","exports","module","./../ext/i18n","./../card-data-broker","./../card-helper","./../card-page-controller","./../utils/number-helper","./../utils/emoji-wrap","./../utils/text-pluralize"],function(e,t,r){"use strict";var n=(e("./../ext/i18n"),e("./../card-data-broker")),o=e("./../card-helper"),i=e("./../card-page-controller"),a=e("./../utils/number-helper"),c=e("./../utils/emoji-wrap"),u=e("./../utils/text-pluralize");r.exports=function(e,t){var r=1e3,s=60,l=60*s,d=24*l,f=1*r,_=[0,0,0,0],p=0,m={attributes:{DISABLED:"disabled",POLL_USER_CHOICE:"data-poll-user-choice",POLL_VOTE_MAJORITY:"data-poll-vote-majority",POLL_CHOICE_INDEX:"data-poll-index",POLL_STATE:"data-poll-state"},selectors:{CONTAINER:"div.PollXChoice",OPTION_CONTAINER:".PollXChoice-optionContainer",OPTIONS:".PollXChoice-choice",BAR:".PollXChoice-choice--chart",OPTION_LABEL:".PollXChoice-choice--text",RADIO_INPUT:".PollXChoice-choice--input",VOTE_BUTTON:"button.PollXChoice-vote--button",RESULT_TEXT:".PollXChoice-progress",FOOTER:".PollXChoice-footer",FOOTER_TOTAL:".PollXChoice-footer--total",FOOTER_TIME:".PollXChoice-footer--time"},translatedStrings:{},actions:{CHOOSE:"click",VOTE:"click"},pollState:{OPENED:"opened",CLOSED:"closed",FINAL:"final"},cardHelper:new o,pageController:new i,twitterInterface:e,cardStorage:t,cardDataBroker:new n,tweetId:null,eventUri:null,cardUri:null,viewerId:null,isAuthor:!1,isLoggedIn:!1,showTwoComponents:!1,userChoice:null,userVote:null,pollContainer:null,choiceCounts:_.slice(),choiceCountsMax:_.slice(),isOpen:null,endTime:null,localTimeDiff:0,dataPollingRequestId:null,votingRequestId:null,_intervalId:null,_toggleUserChoice:function(e){e&&"string"==typeof e?m.pollContainer.setAttribute(m.attributes.POLL_USER_CHOICE,e):m.pollContainer.removeAttribute(m.attributes.POLL_USER_CHOICE)},_preSelectChoice:function(e){var t=m.pollContainer.querySelector(m.selectors.OPTION_CONTAINER+"["+m.attributes.POLL_CHOICE_INDEX+'="'+e+'"] '+m.selectors.RADIO_INPUT);t&&(t.checked=!0),m._processOptionSelection(String(e))},_setContentWithAnimation:function(e,t){""===e.textContent;e.textContent=t},_formatNumber:function(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},_setResult:function(e,t,r){var n=m.selectors.CONTAINER+" "+m.selectors.OPTION_CONTAINER+"["+m.attributes.POLL_CHOICE_INDEX+'="'+e+'"]',o=n+" "+m.selectors.RESULT_TEXT,i=m.cardHelper.queryElement(o);i&&(i.innerHTML=r);var a=n+" label "+m.selectors.BAR,c=m.cardHelper.queryElement(a);c&&(c.style.width=t)},_showWinner:function(){var e=m.attributes.POLL_VOTE_MAJORITY,t=m._generateMajorityString(m.choiceCountsMax.slice(0,p));m.pollContainer.setAttribute(e,t)},_generateMajorityString:function(e){var t="",r=Math.max.apply(null,e);return e.forEach(function(e,n){e&&e===r&&(t+=n+1)}),t},_generateTotalString:function(e){return m.textPluralize("total_count",e,m._formatNumber(e),m.translatedStrings.totalCount)},_setTotal:function(e){var t=m.cardHelper.queryElement(m.selectors.FOOTER_TOTAL);if(t){var r=m._generateTotalString(e);r!==t.textContent&&m._setContentWithAnimation(t,r)}},_generateTimeLeftString:function(e){var t=Math.floor(e/d);e-=t*d;var r=Math.floor(e/l);e-=r*l;var n=Math.floor(e/s),o=[];t>0?(o.push(m.textPluralize("days_left",t,m._formatNumber(t),m.translatedStrings.daysLeft)),r>0&&this.showTwoComponents&&o.push(m.textPluralize("hours_left",r,m._formatNumber(r),m.translatedStrings.hoursLeft))):r>0?(o.push(m.textPluralize("hours_left",r,m._formatNumber(r),m.translatedStrings.hoursLeft)),n>0&&this.showTwoComponents&&o.push(m.textPluralize("minutes_left",n,m._formatNumber(n),m.translatedStrings.minutesLeft))):o.push(m.textPluralize("minutes_left",n,m._formatNumber(n),m.translatedStrings.minutesLeft));var i=o.join(" ");return m.translatedStrings.timeLeft.replace("{{time_left}}",i)},_calculateTimeLeft:function(){return Math.floor((m.endTime-Date.now()-m.localTimeDiff)/r)},_updateEndTime:function(){var e,t=m._calculateTimeLeft();e=m.isOpen?s>t?m.translatedStrings.pollEnding:m._generateTimeLeftString(t):m.translatedStrings.pollEnded;var r=m.cardHelper.queryElement(m.selectors.FOOTER_TIME);r&&r.textContent!==e&&m._setContentWithAnimation(r,e)},_calculatePercentage:function(e,t){return 0===t?0:e>=t?100:Math.round(e/t*100)},_getTotal:function(e){return e.reduce(function(e,t){return e+t},0)},_updateTotal:function(){var e=m._getTotal(m.choiceCountsMax);m._setTotal(e)},_updateResults:function(){var e,t,r=[],n=[],o=[],i=m._getTotal(m.choiceCountsMax);if(i>0){for(e=0;p>e;e++)r[e]=m._calculatePercentage(m.choiceCountsMax[e],i);for(t=m._getTotal(r),m.choiceCountsMax[p-1]&&100!==t&&(r[p-1]-=t-100),e=0;p>e;e++)o[e]=n[e]=r[e]+"%";o=m._prependPadding(o)}else for(e=0;p>e;e++)o[e]=n[e]="0%";for(e=0;p>e;e++)m._setResult(e+1,n[e],o[e])},_prependPadding:function(e){var t=0;return e.forEach(function(e){e.length>t&&(t=e.length)}),e.forEach(function(r,n){var o=t-r.length;if(o){var i="<span>"+Array(o+1).join("0")+"</span>";e[n]=i+e[n]}}),e},_resetResults:function(){for(var e=1;p>=e;e++)m._setResult(e,"0%","0%")},_updateVoteOptions:function(){if(!m.isOpen)for(var e,t=m.pollContainer.querySelectorAll(m.selectors.OPTIONS),r=0;e=t[r];r++)e.setAttribute(m.attributes.DISABLED,!0),e.removeEventListener(m.actions.CHOOSE,m._handleOptionClick)},_updateVoteButton:function(){if(m.voteButton){var e="string"==typeof m.userChoice,t="string"==typeof m.votingRequestId,r="string"==typeof m.userVote,n=!m.isOpen;m.voteButton.textContent=m.translatedStrings.voteEnabled,t||r||n?(m.voteButton.removeEventListener(m.actions.VOTE,m._handleVoteClick),m.voteButton.setAttribute(m.attributes.DISABLED,!0)):m.isOpen&&e?(m.voteButton.addEventListener(m.actions.VOTE,m._handleVoteClick),m.voteButton.removeAttribute(m.attributes.DISABLED)):(m.voteButton.removeEventListener(m.actions.VOTE,m._handleVoteClick),m.voteButton.setAttribute(m.attributes.DISABLED,!0))}},_getNumberOfChoices:function(){return p},_countVote:function(){m.isOpen&&m.userChoice>0&&m.userChoice<=p&&(m.choiceCountsMax[m.userChoice-1]=m.choiceCounts[m.userChoice-1]+1)},_reverseVoteCounts:function(){m.choiceCounts.forEach(function(e,t){m.choiceCountsMax[t]=e})},_updateMaxCount:function(){m.choiceCounts.forEach(function(e,t){e>m.choiceCountsMax[t]&&(m.choiceCountsMax[t]=e)})},_postVote:function(e){"string"==typeof e&&m.eventUri&&(m.votingRequestId=m.cardDataBroker.doWrite({"twitter:string:card_uri":m.cardUri,"twitter:long:original_tweet_id":m.tweetId,"twitter:string:selected_choice":e}),m._scribePromotedTweetVote())},_scribePromotedTweetVote:function(){m.twitterInterface._getImpressionId()&&m.twitterInterface._logPromotedInfo({delegateTarget:m.pollContainer},!1)},_startDataPolling:function(){m.dataPollingRequestId||(m.dataPollingRequestId=m.cardDataBroker.doRead({"twitter:string:card_uri":m.cardUri,"twitter:long:original_tweet_id":m.tweetId},!0))},_stopDataPolling:function(){m.dataPollingRequestId&&(m.cardDataBroker.cancel(m.dataPollingRequestId),m.dataPollingRequestId=null)},_handleDataUpdate:function(e,t,r){var n=m.pageController.getCurrentPage();n&&"function"==typeof n.onDataUpdate&&n.onDataUpdate(e,t,r)},_handleDataError:function(e,t,r){var n=m.pageController.getCurrentPage();n&&"function"==typeof n.onDataError&&n.onDataError(e,t,r)},_handleOptionClick:function(e){m._processOptionSelection(e.target.getAttribute(m.attributes.POLL_CHOICE_INDEX))},_processOptionSelection:function(t){m.userChoice=t,m.voteButton.setAttribute(e.dataAttrs.SCRIBE_DATA,'{"user_choice": '+m.userChoice+"}"),m._updateVoteButton()},_handleVoteClick:function(e){var t=m.pageController.getCurrentPage();"string"==typeof m.userChoice&&t&&"function"==typeof t.onVote&&t.onVote()},_setupDataBroker:function(e){var t={tweetId:e.card.tweet_id,cardName:e.card.card_name,uri:e.card.capi,token:e.card.token,forward:e.card.forward,originalData:e.card.original,refreshInterval:a.parseInt(e.card.refresh_interval)};m.cardDataBroker.init(t),m.cardDataBroker.register(m._handleDataUpdate,m._handleDataError)},_onTick:function(){},_processOptionStrings:function(){for(var e,t=m.pollContainer.querySelectorAll(m.selectors.OPTION_LABEL),r=0;e=t[r];r++)e.innerHTML=c(e.innerHTML)},_mergeSelectedChoice:function(e){e&&e!==m.userChoice&&(m.userChoice=m.userVote=e,m._reverseVoteCounts(),m._saveLocalData())},_saveLocalData:function(){var e;m.cardStorage&&(e={userVote:m.userVote},m.choiceCountsMax.forEach(function(t,r){e[m._buildKeyNameByIndex("choice",r)+"CountMax"]=t}),m.cardStorage.setData(e,function(){}))},_buildKeyNameByIndex:function(e,t){return e+(t+1)},init:function(e,t){if(m.pollContainer=document.querySelector(m.selectors.CONTAINER),m.pollContainer){m.eventUri=e.card.capi,m.tweetId=e.card.tweet_id,m.cardUri=e.card.card_uri,m.viewerId=e.card.viewer_id,m.isAuthor=e.card.is_author,m.isLoggedIn=e.card.is_logged_in,m.showTwoComponents=e.card.show_two_components,p=a.parseInt(e.card.choice_count),m.choiceCountsMax.forEach(function(t,r){var n=m._buildKeyNameByIndex("count",r);m.choiceCountsMax[r]=m.choiceCounts[r]=a.parseInt(e.card[n])}),m.isOpen="true"===e.card.is_open.toLowerCase(),m.endTime=Date.parse(e.card.end_time),m.localTimeDiff=Date.parse(e.card.current_time)-Date.now()||0;for(var r,n=m.pollContainer.querySelectorAll(m.selectors.BAR),o=0;r=n[o];o++)r.style.width="0%";if(m.cardStorage){var i=m.cardStorage.cache;i&&"string"==typeof i.userVote&&(m.userChoice=m.userVote=i.userVote,m.isOpen&&(m.choiceCountsMax.forEach(function(e,t){var r=m._buildKeyNameByIndex("choice",t)+"CountMax";m.choiceCountsMax[t]=a.parseInt(i[r])}),m._updateMaxCount()))}m._mergeSelectedChoice(e.card.selected_choice),m.textPluralize=new u(e.card.language),m.translatedStrings={voteEnabled:e.strings.vote,voteSubmitted:e.strings.vote_submitted,pollEnding:e.strings.poll_ending,pollEnded:e.strings.final_results,totalCount:e.strings.total_count,minutesLeft:e.strings.minutes_left,hoursLeft:e.strings.hours_left,daysLeft:e.strings.days_left,timeLeft:e.strings.time_left},m.isOpen?e.card.is_logged_in?(m._setupDataBroker(e),m.pageController.init(m.votingPage),m._startDataPolling(),m._intervalId=setInterval(m._onTick,f)):m.pageController.init(m.votingPage):(m.pageController.init(m.resultPage),m._updateTotal());for(var c,s=m.pollContainer.querySelectorAll(m.selectors.OPTIONS),o=0;c=s[o];o++)c.addEventListener(m.actions.CHOOSE,m._handleOptionClick);m.voteButton=m.pollContainer.querySelectorAll(m.selectors.VOTE_BUTTON)[0],t&&"choice"in t&&m._preSelectChoice(t.choice),m._updateVoteButton(),m._updateEndTime(),m._processOptionStrings(),setTimeout(function(){m.pollContainer.classList.remove("PollXChoice--noTransitions")},1e3)}},deinit:function(){m._stopDataPolling(),m.cardDataBroker.cancelAll(),m.cardDataBroker.unregister(),m._intervalId&&(clearInterval(m._intervalId),m._intervalId=null)},resultPage:{load:function(){"string"==typeof m.userVote&&m._toggleUserChoice(m.userChoice),m._stopDataPolling(),m._updateVoteButton(),m._updateResults(),m._showWinner(),m._updateEndTime()}},votingPage:{load:function(){m.isAuthor?(m.votingPage._showResults(),m._updateResults()):"string"==typeof m.userVote&&(m.votingPage._showResults(),m._updateResults(),m._toggleUserChoice(m.userChoice)),m._updateTotal()},onVote:function(){"string"==typeof m.userChoice&&m.isLoggedIn&&(m._postVote(m.userChoice),m._countVote(),m._updateVoteButton(),m.votingPage._showResults(),m._toggleUserChoice(m.userChoice),m._updateResults())},onDataUpdate:function(e,t,r){var n=m.isOpen;r===m.votingRequestId?(m.votingPage._processVoteResponse(t),m._mergeSelectedChoice(t.selectedChoice),m._updateVoteButton(),m._toggleUserChoice(m.userChoice),m._updateResults(),m._saveLocalData()):(m.votingPage._processGetResponse(t),m._mergeSelectedChoice(t.selectedChoice),m.isAuthor?m._updateResults():"string"==typeof m.userVote&&(m.votingPage._showResults(),m._updateVoteButton(),m._toggleUserChoice(m.userChoice),m._updateResults())),n&&!m.isOpen&&(m._stopDataPolling(),m.votingPage._showResults(),m._showWinner(),m._updateVoteButton(),m._updateResults()),m._updateTotal(),m._updateEndTime()},onDataError:function(e,t,r){r===m.votingRequestId&&(m.votingRequestId=null,m._reverseVoteCounts(),m._resetResults(),m.votingPage._revertToVoteState(),m._updateVoteButton()),m._updateEndTime()},_processVoteResponse:function(e){m.userVote=m.userChoice,m.votingRequestId=null,m.votingPage._processGetResponse(e)},_processGetResponse:function(e){var t=0;if(m.isOpen=!e.countsAreFinal,m.choiceCounts.forEach(function(t,r){var n=m._buildKeyNameByIndex("choice",r)+"Count";m.choiceCounts[r]=a.parseInt(e[n])}),e.selected_choice)for(m.userChoice=m.userVote=e.selected_choice,t=0;p>t;t++)m.choiceCountsMax[t]=m.choiceCounts[t];if(m.isOpen)m._updateMaxCount();else for(t=0;p>t;t++)m.choiceCountsMax[t]=m.choiceCounts[t]},_showResults:function(){m.pollContainer.setAttribute(m.attributes.POLL_STATE,m.pollState.CLOSED)},_revertToVoteState:function(){m.pollContainer.setAttribute(m.attributes.POLL_STATE,m.pollState.OPENED),m.pollContainer.removeAttribute(m.attributes.POLL_VOTE_MAJORITY),m.pollContainer.removeAttribute(m.attributes.POLL_USER_CHOICE)}}};return m}});var n={indexedDB:window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,onError:null,indexedDbVersion:1,DB_INDEXING_KEY:"item",Depot:function(e){this.name=e,this.getItem=function(e,t){n._Depot.getItem(this,e,t)},this.getKeys=function(e){n._Depot.getKeys(this,e)},this.setItem=function(e,t,r){n._Depot.setItem(this,e,t,r)},this.hasItem=function(e,t){n._Depot.hasItem(this,e,t)},this.removeItem=function(e,t){n._Depot.removeItem(this,e,t)},this.clear=function(){n._Depot.clear(this)}},_Depot:{getItem:function(e,t,r){n.indexedDB?n._Depot.openIndexedDb(e.name,n.indexedDbVersion,function(o){try{var i,a,c;a=o.transaction([e.name]),i=a.objectStore(e.name),c=i.get(t),c.onsuccess=function(e){var t=e.target.result;"function"==typeof r&&r(t?t.data:void 0),n._Depot.closeIndexedDb(o)},c.onerror=function(e){"function"==typeof r&&r(void 0),n._Depot.closeIndexedDb(o)}}catch(u){r(void 0)}}):r(void 0)},getKeys:function(e,t){n.indexedDB?n._Depot.openIndexedDb(e.name,n.indexedDbVersion,function(r){var o,i,a,c=[];i=r.transaction([e.name]),o=i.objectStore(e.name),a=o.openCursor(),a.onsuccess=function(e){var o=e.target.result;o?(c.push(o.value.item),o["continue"]()):("function"==typeof t&&t(c),n._Depot.closeIndexedDb(r))},a.onerror=function(e){"function"==typeof t&&t(c),n._Depot.closeIndexedDb(r)}}):t([])},setItem:function(e,t,r,o){n.indexedDB?n._Depot.openIndexedDb(e.name,n.indexedDbVersion,function(i){var a,c,u=i.transaction([e.name],"readwrite");a=u.objectStore(e.name),u.oncomplete=function(e){"function"==typeof o&&o(!0),n._Depot.closeIndexedDb(i)},u.onerror=function(e){"function"==typeof o&&o(!1),n._Depot.closeIndexedDb(i)},c=a.put({item:t,data:r})}):o(!1)},hasItem:function(e,t,r){n.indexedDB?n._Depot.getItem(e,t,function(e){r("undefined"!=typeof e?!0:!1)}):r(!1)},removeItem:function(e,t,r){n.indexedDB?n._Depot.openIndexedDb(e.name,n.indexedDbVersion,function(o){var i,a,c;a=o.transaction([e.name],"readwrite"),i=a.objectStore(e.name),c=i["delete"](t),c.onsuccess=function(e){"function"==typeof r&&r(!0),n._Depot.closeIndexedDb(o)},c.onerror=function(e){"function"==typeof r&&r(!1),n._Depot.closeIndexedDb(o)}}):r(!1)},clear:function(e){n.indexedDB&&n._Depot.openIndexedDb(e.name,n.indexedDbVersion,function(t){n.indexedDB.deleteDatabase(e.name),n._Depot.closeIndexedDb(t)})},openIndexedDb:function(e,t,r){try{var o=n.indexedDB.open(e,t);o.onerror=function(e){r(null)},o.onupgradeneeded=function(t){if(!o.result.objectStoreNames.contains(e)){var r=o.result.createObjectStore(e,{keyPath:n.DB_INDEXING_KEY});r.createIndex(n.DB_INDEXING_KEY,n.DB_INDEXING_KEY,{unique:!0})}},o.onsuccess=function(e){"function"==typeof r&&r(o.result)}}catch(i){r(null)}},closeIndexedDb:function(e){if(e&&e.close)try{e.close()}catch(t){}}},requestDepot:function(e,t,r){n._hasDepot(e,function(o){o?t(n._getDepot(e)):n._createDepot(e,t,r)})},hasDepot:function(e,t){"string"==typeof e&&"function"==typeof t?n._hasDepot(e,t):"function"==typeof t&&t(!1)},deleteDepot:function(e,t){if(n.indexedDB){var r=n.indexedDB.deleteDatabase(e);r.onsuccess=function(){"function"==typeof t&&t(!0)},r.onerror=function(){"function"==typeof t&&t(!1)}}else t(!1)},_hasDepot:function(e,t){if(n.indexedDB&&n.indexedDB.open){var r=n.indexedDB.open(e);r.onupgradeneeded=function(e){t(!1)},r.onsuccess=function(){"function"==typeof t&&(n._Depot.closeIndexedDb(r),t(!0))},r.onerror=function(e){e&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&e.preventDefault(),"function"==typeof t&&(n._Depot.closeIndexedDb(r),t(!1))}}else t(!1)},_getDepot:function(e){return new n.Depot(e)},_createDepot:function(e,t,r){n.indexedDB?n._createIndexedDbInstance(e,t,r):r()},_createIndexedDbInstance:function(e,t,r){var o=n.indexedDB.open(e,n.indexedDbVersion);o.onerror=function(e){e&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&e.preventDefault(),"function"==typeof r&&r(e),"function"==typeof n.onError&&n.onError(e)},o.onupgradeneeded=function(t){if(!o.result.objectStoreNames.contains(e)){var r=o.result.createObjectStore(e,{keyPath:n.DB_INDEXING_KEY});r.createIndex(n.DB_INDEXING_KEY,n.DB_INDEXING_KEY,{unique:!0})}},o.onsuccess=function(r){"function"==typeof t&&(t(new n.Depot(e)),n._Depot.closeIndexedDb(o.result))}}};r("../native/js/storage/localdepot.min",function(){}),r("../native/js/storage/card-storage",["require","exports","module","./localdepot.min"],function(e,t,r){"use strict";e("./localdepot.min"),r.exports=function(){var e={_depot:null,_name:null,_table:null,_MAX_CARDS_STORED_PER_TYPE:30,_DB_VERSION:20151105,_cardMaxOverride:null,cache:null,getData:function(t){try{e._depot.getItem(e._name,function(e){t(e?e.data:void 0)})}catch(r){t()}},setData:function(t,r){if(e._depot)try{e._depot.hasItem(e._name,function(n){n||e._getCards(function(t){var r=e._cardMaxOverride||e._MAX_CARDS_STORED_PER_TYPE;if(t.length>=r){t.sort(function(e,t){return e.date-t.date});for(var n=t.length-r+1,o=0;n>o;o++)e._depot.removeItem(t[o].key)}}),e._depot.setItem(e._name,{data:t,date:(new Date).getTime(),key:e._name},r)})}catch(n){r(!1)}else e._getDepot(e._table,function(n){n?e.setData(t,r):r(!1)})},removeData:function(t){try{e._depot.removeItem(e._name,t)}catch(r){t(!1)}},init:function(t,r,o,i){e._table=t,e._name=r,e._cardMaxOverride=i,n.indexedDbVersion=e._DB_VERSION;try{n.hasDepot(t,function(r){r?e._getDepot(t,o):o(!1)})}catch(a){o(!1)}},_getCards:function(t){try{e._depot.getKeys(function(r){for(var n,o=[],i=r.length,a=0;n=r[a];a++)e._depot.getItem(n,function(e){o.push(e),i===o.length&&t(o)});i||t([])})}catch(r){t([])}},_getDepot:function(t,r){try{n.requestDepot(t,function(t){e._depot=t,e.getData(function(t){e.cache=t,r(!0)})},function(){r(!1)})}catch(o){r(!1)}}};return e}}),r("../native/js/flock/flock2unlock",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e){var t={_twitterInterface:e,_cardData:null,_cardStorage:null,init:function(e,r,n){t._cardData=e,t._cardStorage=r,e.locked?t._cardStorage.getData(t._showLocked):e.video_unlocked&&"function"==typeof n&&n()},_showLocked:function(e){var r=parseInt(t._cardData.percentage),n=document.querySelector(".FlockCard-progress span"),o=document.querySelector(".FlockCard-image img");if(o.addEventListener("load",t._twitterInterface.handleResize),setTimeout(function(){n.style.width=r+"%"},100),e&&e.voted)t._showParticipated();else{var i=document.querySelector(".FlockCard-button--cta button");i&&i.addEventListener("click",t._handleFlockButtonClick),o&&(o.src=o.getAttribute("data-src"))}},_showParticipated:function(){var e=document.querySelector(".FlockCard-button--cta");e&&(e.parentElement.removeChild(e),document.querySelector(".FlockCard-image img").src=t._cardData.participated_image.image_url)},_tweetToUnlock:function(){var e=t._cardData.compose;e&&e.length<140&&(e+=" "),setTimeout(t._showParticipated,150),t._twitterInterface.composeTweet({
tweetText:e||"",scribeData:t._twitterInterface.config.scribeData}),t._cardStorage.setData({voted:!0})},_handleFlockButtonClick:function(){t._tweetToUnlock(),t._twitterInterface.handleResize()}};return t}}),r("../native/js/promo_convo/convo",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e,t){var r={selectors:{CARD_CONTAINER:".ConvoCard",CHOICE_ELEMENT:".ConvoCard-choice",CONTENT_CONTAINER:".ConvoCard-titleButtonContent",THANK_YOU_CONTAINER:".ConvoCard-thankYouContent",UNLOCK_COVER_CONTAINER:".ConvoCard-unlockCover",UNLOCK_MEDIA_CONTAINER:".ConvoCard-unlockMedia",UNLOCK_VIDEO_MEDIA:".ConvoCard-unlockMediaVideo"},cssClass:{HIDDEN:"ConvoCard--hidden"},uiEvents:{SEND_TWEET:"uiSendTweet"},cardContainer:null,choiceElements:null,contentContainer:null,thankYouContainer:null,unlockCoverContainer:null,unlockMediaContainer:null,unlockVideoMedia:null,_cardStorage:t,_videoInit:null,init:function(e){r._videoInit=e,r.cardContainer=document.querySelector(r.selectors.CARD_CONTAINER),r.contentContainer=document.querySelector(r.selectors.CONTENT_CONTAINER),r.thankYouContainer=document.querySelector(r.selectors.THANK_YOU_CONTAINER),r.choiceElements=document.querySelectorAll(r.selectors.CHOICE_ELEMENT),r.unlockCoverContainer=document.querySelector(r.selectors.UNLOCK_COVER_CONTAINER),r.unlockMediaContainer=document.querySelector(r.selectors.UNLOCK_MEDIA_CONTAINER),r.unlockVideoMedia=document.querySelector(r.selectors.UNLOCK_VIDEO_MEDIA),(!r.unlockCoverContainer||r.unlockVideoMedia)&&r._callVideoInit(),r.isTweeted()?r.showTweetedContent():r.setupChoiceClickHandlers()},isTweeted:function(){return!!(r._cardStorage&&r._cardStorage.cache&&r._cardStorage.cache.tweeted)},markAsTweeted:function(){r._cardStorage&&!r.isTweeted()&&r._cardStorage.setData({tweeted:!0})},_callVideoInit:function(e){"function"==typeof r._videoInit&&r._videoInit(e)},_callVideoDestroy:function(){e&&"function"==typeof e.destroyVideoPlayer&&e.destroyVideoPlayer()},showTweetedContent:function(t){r.showThankYouMessage(),r.unlockMedia(t&&t.autoplay),e&&("function"==typeof e.handleResize&&e.handleResize(),"function"==typeof e.unsubscribeToEvent&&e.unsubscribeToEvent(r.uiEvents.SEND_TWEET))},showThankYouMessage:function(){if(r.contentContainer&&r.contentContainer.classList.add(r.cssClass.HIDDEN),r.thankYouContainer){r.thankYouContainer.classList.remove(r.cssClass.HIDDEN);var e=r._getThankYouUrl(r.thankYouContainer);e&&r._linkifyAnchorElement(r.cardContainer,e)}},_linkifyAnchorElement:function(t,r){t&&r&&"A"===t.tagName&&(t.href=r,t.addEventListener("click",e.handlePromotedEngagement))},_getThankYouUrl:function(e){return e&&e.getAttribute("data-thank-you-url")},unlockMedia:function(e){r.unlockCoverContainer&&(r.unlockCoverContainer.classList.add(r.cssClass.HIDDEN),r.unlockMediaContainer&&(r.unlockMediaContainer.classList.remove(r.cssClass.HIDDEN),r.unlockVideoMedia&&(r._callVideoDestroy(),r.unlockCoverContainer.innerHTML="",r.unlockMediaContainer.innerHTML=r.unlockVideoMedia.innerHTML),r._callVideoInit(e)))},setupChoiceClickHandlers:function(){for(var e,t=0;e=r.choiceElements[t];t++)e.addEventListener("click",r.handleChoiceClick)},handleChoiceClick:function(t){e&&("function"==typeof e.handlePromotedEngagement&&e.handlePromotedEngagement(t,!0),"function"==typeof e.subscribeToEvent&&e.subscribeToEvent(r.uiEvents.SEND_TWEET,r.handleTweetCreated))},handleTweetCreated:function(){r.markAsTweeted(),r.showTweetedContent({autoplay:!0})}};return r}}),r("../native/js/message_me/message_me",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e){var t={scribeConstants:{ELEMENT:"platform_card",IMPRESSION_ACTION:"message_me_show"},init:function(){t._fromConfigCard("render_card")&&t.scribeMessageMeShow()},scribeMessageMeShow:function(){e.host.scribe({customScribe:{element:t.scribeConstants.ELEMENT,action:t.scribeConstants.IMPRESSION_ACTION,itemData:t._scribeItemData()},scribeData:t._fromConfig("scribeData")})},_fromConfig:function(r){return t._fromDict(e.config,r)},_fromConfigCard:function(e){var r=t._fromConfig("card");return t._fromDict(r,e)},_fromDict:function(e,t){return e&&t in e?e[t]:null},_scribeItemData:function(){return{card_event:{card_user_data:{binding_values:[{name:"viewing_user_id",value:t._fromConfigCard("viewer_id")}]}}}}};return t}}),r("../native/js/periscope/periscope",["require","exports","module","./../utils/number-helper","./../card-data-broker"],function(e,t,r){"use strict";var n=e("./../utils/number-helper"),o=e("./../card-data-broker");r.exports=function(e){var t={_twitterInterface:e,_selectors:{IFRAME:"#ExternalIframeContainer iframe"},_eventTypes:{INIT:"init",UPDATE:"update",UPDATE_ERROR:"update_error",OPEN_LINK:"open_link",START_PLAYING:"start_playing",STOP_PLAYING:"stop_playing",STOP_POLLING:"stop_polling"},_cardDataBroker:new o,_dataPollingRequestId:null,_periscopeOrigins:{PERISCOPE_TV:"https://periscope.tv",WWW_PERISCOPE_TV:"https://www.periscope.tv"},_iframeInitialized:!1,_iframeOrigin:null,_iframe:null,_periscopeInitData:null,_cardUri:null,_broadcastId:null,_pendingAutoPlayEvent:null,_autoPlayPreview:function(){t._handleAutoPlayEvent(t._eventTypes.START_PLAYING)},_autoPlayPreviewStop:function(){t._handleAutoPlayEvent(t._eventTypes.STOP_PLAYING)},_handleAutoPlayEvent:function(e){t._iframeInitialized?t._sendPeriscopeMessage({type:e}):t._pendingAutoPlayEvent=e},_sendPendingAutoPlayEvent:function(){var e=t._pendingAutoPlayEvent;"string"==typeof e&&(t._pendingAutoPlayEvent=null,t._sendPeriscopeMessage({type:e}))},callMethodByName:function(){var e=arguments[0],r=Array.prototype.slice.call(arguments,1);t._localRpcMethods[e].apply(this,r)},_handleDataUpdate:function(e,r,n){t._updatePeriscopeWindow(r)},_handleDataError:function(e,r,n){t._updateError(r.status),t._stopDataPolling()},_startDataPolling:function(){t._dataPollingRequestId||(t._dataPollingRequestId=t._cardDataBroker.doRead({"twitter:string:card_uri":t._cardUri,"twitter:text:id":t._broadcastId},!0))},_stopDataPolling:function(){t._dataPollingRequestId&&(t._cardDataBroker.cancel(t._dataPollingRequestId),t._dataPollingRequestId=null)},_setupDataBroker:function(e){var r={tweetId:e.tweet_id,cardName:e.card_name,uri:e.capi,token:e.token,forward:e.forward,originalData:e.original,refreshInterval:n.parseInt(e.refresh_interval)};t._cardDataBroker.init(r),t._cardDataBroker.register(t._handleDataUpdate,t._handleDataError)},_eventOrigin:function(e){return e.origin||e.originalEvent.origin},_verifyPeriscopeOrigin:function(e){return e===t._periscopeOrigins.PERISCOPE_TV||e===t._periscopeOrigins.WWW_PERISCOPE_TV},_handleMessage:function(e){var r=t._eventOrigin(e);if(t._verifyPeriscopeOrigin(r))switch(e.data.type){case t._eventTypes.INIT:t._iframeOrigin=r,t._iframeInitialized=!0,t._initPeriscopeWindow(),t._startDataPolling(),t._sendPendingAutoPlayEvent();break;case t._eventTypes.OPEN_LINK:e.data.url&&t._twitterInterface.handleOpenPeriscopeLink(e.data.url);break;case t._eventTypes.STOP_POLLING:t._stopDataPolling()}},_updateError:function(e){t._sendPeriscopeMessage({type:t._eventTypes.UPDATE_ERROR,status:e})},_initPeriscopeWindow:function(){t._sendPeriscopeMessage({type:t._eventTypes.INIT,cardData:t._periscopeInitData})},_updatePeriscopeWindow:function(e){t._sendPeriscopeMessage({type:t._eventTypes.UPDATE,cardData:e})},_sendPeriscopeMessage:function(e){var r=t._iframe&&t._iframe.contentWindow;r&&r.postMessage(e,t._iframeOrigin)},init:function(e){window.addEventListener("message",t._handleMessage,!0),t._iframe=document.querySelector(t._selectors.IFRAME),t._periscopeInitData=e.card,t._broadcastId=e.card.id,t._cardUri=e.card.card_uri,t._setupDataBroker(e.card)},deinit:function(){t._stopDataPolling(),t._cardDataBroker.cancelAll(),t._cardDataBroker.unregister()}};return t._localRpcMethods={autoPlayPreview:t._autoPlayPreview,autoPlayPreviewStop:t._autoPlayPreviewStop},t}}),r("../native/js/player/player",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e){var t={_twitterInterface:e,_selectors:{CONTAINER_PREVIEW:".PlayerCard--preview",CONTAINER_VIDEO:".PlayerCard--video"},_elements:{},_videoInit:null,init:function(e){t._videoInit=e;var r=t._elements.preview=document.querySelector(t._selectors.CONTAINER_PREVIEW);r?r.addEventListener("click",t._handleShowVideo):"function"==typeof e&&e(),t._twitterInterface.handleResize()},_handleShowVideo:function(){var e=t._elements.video=document.querySelector(t._selectors.CONTAINER_VIDEO),r=t._elements.preview,n=e.querySelector("iframe");r&&(r.removeEventListener("click",t._handleShowVideo),r.style.display="none"),e.style.display="block",n.setAttribute("src",t._getVideoSrc(n)),t._videoInit(),t._twitterInterface.handleResize()},_getVideoSrc:function(e){var t=document.createElement("a");t.setAttribute("href",e.getAttribute("data-src"));var r=t.search&&t.search.length>0?"&":"?";return t.search+=r+"autoplay=1&auto_play=true",t.href}};return t}}),r("../native/js/live_video/live_video",["require","exports","module","delegate","./../utils/number-helper","./../card-data-broker"],function(e,t,r){"use strict";var n=e("delegate"),o=(e("./../utils/number-helper"),e("./../card-data-broker"));r.exports=function(e){var t=1e3,r=60*t,i=60*r,a=24*i,c={attributes:{DATA_PLAYER_URL:"data-player-url",DATA_STATE_LIVE:"data-state-live",DATA_PLAYING_AD:"data-playing-ad"},cssClasses:{CARD_CONTAINER_LIVE:["PlayerCard--video"],CARD_CONTAINER_NOT_LIVE:["js-openLink","u-block"],CARD_CONTAINER_POSTLIVE:["LiveVideoCard-postlive"],PILL_LIVE:["TwitterCard-pill--red"],PILL_NOT_LIVE:["TwitterCard-pill--dark"],VIDEO_CONTAINER_LIVE:["PlayerCard-videoContainer"]},selectors:{CARD_CONTAINER:".LiveVideoCard",CONTENT_CONTAINER:".SummaryCard-content",IMAGE_ELEMENT:".LiveVideoCard-imageContainer img",IMAGE_WRAPPER:".LiveVideoCard-imageContainer .tcu-imageWrapper",MEDIA_CONTAINER:".LiveVideoCard-mediaContainer",OPEN_LINK:".js-openLink",PILL_ELEMENT:".TwitterCard-pill",PLAYER_CONTAINER:".AmplifyContainer",STATIC_CONTENT_CONTAINER:".LiveVideoCard-contentContainer--static",VIDEO_CONTAINER:".LiveVideoCard-videoContainer",VIDEO_CONTENT_CONTAINER:".LiveVideoCard-contentContainer--video"},cardState:{LIVE:"live",PRELIVE:"prelive",POSTLIVE:"postlive"},copyString:{},element:{},methodCallbacks:{videoPlayerAdStart:function(){c.element.cardContainer.setAttribute(c.attributes.DATA_PLAYING_AD,"true")},videoPlayerAdEnd:function(){c.element.cardContainer.setAttribute(c.attributes.DATA_PLAYING_AD,"false")}},refreshRate:{},serialization:null,timeToEvent:0,eventTime:{currentUserDiff:0},twitterInterface:e,_cardDataBroker:new o,_dataPollingRequestId:null,_currentState:"loading",_hasVideoInit:!1,_initPlayer:null,_playerEnabled:!0,_timeFormat:{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"},init:function(e,t){var r=c.serialization=e.card;c.copyString={ended:r.copy_ended,live:r.copy_live,starting_soon:r.copy_starting_soon,starting_minute:r.copy_starting_minute,starting_in:r.copy_starting_in,starting_on:r.copy_starting_on},c.refreshRate={prelive:r.refresh_rate_prelive,live:r.refresh_rate_live,postlive:r.refresh_rate_postlive},c._playerEnabled=r.player_enabled,c._initPlayer=function(){if(c._hasVideoInit)c._previewVideo();else{c._hasVideoInit=!0;try{t(!1,JSON.parse(decodeURIComponent(r.scribe_context)),c.methodCallbacks)}catch(e){t(!1)}}},c.element={pill:document.querySelector(c.selectors.PILL_ELEMENT),cardContainer:document.querySelector(c.selectors.CARD_CONTAINER),mediaContainer:document.querySelector(c.selectors.MEDIA_CONTAINER),contentContainer:document.querySelector(c.selectors.CONTENT_CONTAINER),videoContentContainer:document.querySelector(c.selectors.VIDEO_CONTENT_CONTAINER),staticContentContainer:document.querySelector(c.selectors.STATIC_CONTENT_CONTAINER),videoPlayerContainer:document.querySelector(c.selectors.PLAYER_CONTAINER),image:document.querySelector(c.selectors.IMAGE_ELEMENT),imageWrapper:document.querySelector(c.selectors.IMAGE_WRAPPER)},c._initCardState(e.card),n(document).on("click",c.selectors.OPEN_LINK,c._handleCardClick),n(document).on("click",c.selectors.VIDEO_CONTAINER,function(e){e.preventDefault()}),c._cardUri=r.card_uri,c._setupDataBroker(r),c._startDataPolling()},deinit:function(){c._stopDataPolling(),c._cardDataBroker.cancelAll(),c._cardDataBroker.unregister()},_initCardState:function(e){var t=c.serialization=e;switch(c._currentState=t.state.toLowerCase()){case"prelive":c._updateEventTime(t.start_time,t.current_time),c._supportsLocales()&&c.timeToEvent>a&&c._updatePillElement(c.copyString.starting_on.replace("%s",new Date(Number(t.start_time)).toLocaleString([],c._timeFormat))),c._tickCountDown(),c._stopVideo();break;case"live":"function"==typeof c._initPlayer&&c._initPlayer();break;case"postlive":c._stopVideo()}},_renderState:function(e){var t=e.state.toLowerCase(),r=c.element.cardContainer,n=c.element.mediaContainer,o=c.element.contentContainer,i=c.element.videoContentContainer,a=c.element.staticContentContainer,u=c.element.videoPlayerContainer,s=c.element.pill,l=c.element.image,d=c.element.imageWrapper;switch(t){case c.cardState.PRELIVE:case c.cardState.POSTLIVE:c._currentState=t,r.classList.remove(c.cssClasses.CARD_CONTAINER_LIVE),r.classList.add(c.cssClasses.CARD_CONTAINER_NOT_LIVE),r.setAttribute(c.attributes.DATA_STATE_LIVE,"false"),t===c.cardState.POSTLIVE&&r.classList.add(c.cssClasses.CARD_CONTAINER_POSTLIVE),n.classList.remove(c.cssClasses.VIDEO_CONTAINER_LIVE),a.appendChild(o),c._updatePillElement(t===t.PRELIVE?c.copyString.starting_soon:c.copyString.ended),s.classList.remove(c.cssClasses.PILL_LIVE),s.classList.add(c.cssClasses.PILL_NOT_LIVE),"thumbnail"in e&&(l.src=e.thumbnail.url,d.style.backgroundImage="url("+e.thumbnail.url+")");break;case c.cardState.LIVE:c._currentState=t,c._playerEnabled&&e.player_url&&(u.setAttribute(c.attributes.DATA_PLAYER_URL,e.player_url),r.classList.remove(c.cssClasses.CARD_CONTAINER_NOT_LIVE),r.classList.add(c.cssClasses.CARD_CONTAINER_LIVE),r.setAttribute(c.attributes.DATA_STATE_LIVE,"true"),r.classList.remove(c.cssClasses.CARD_CONTAINER_POSTLIVE),n.classList.add(c.cssClasses.VIDEO_CONTAINER_LIVE),i.appendChild(o)),c._updatePillElement(c.copyString.live),s.classList.remove(c.cssClasses.PILL_NOT_LIVE),s.classList.add(c.cssClasses.PILL_LIVE)}c._initCardState(e)},_tickCountDown:function(){c.timeToEvent<=a&&(c.timeToEvent>=r?(c._updatePillElement(c.copyString.starting_in.replace("00:00",'<span class="LiveVideoCard-timer">'+c._getTimeLeft()+"</span>")),setTimeout(c._tickCountDown,t),c.timeToEvent-=t):c.timeToEvent>0?(c._updatePillElement(c.copyString.starting_minute),setTimeout(c._tickCountDown,t)):c._updatePillElement(c.copyString.starting_soon))},_updateEventTime:function(e,t){c.eventTime.start=e,c.eventTime.current=t,c.timeToEvent=e-t},_getTimeLeft:function(){var e=c._getTimeDigitString(Math.floor(c.timeToEvent/t)%60),n=c._getTimeDigitString(Math.floor(c.timeToEvent/r)%60),o=c._getTimeDigitString(Math.floor(c.timeToEvent/i)%24);return o+":"+n+":"+e},_getTimeDigitString:function(e){var t=String(e);return 1===t.length?t="0"+t:t.length<1&&(t="00"),t},_supportsLocales:function(){try{(new Date).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1},_updatePillElement:function(e){var t=c.element.pill;t&&(t.innerHTML=e)},_handleCardClick:function(){c._stopVideo(),c._stopDataPolling()},_previewVideo:function(){c.twitterInterface.callVideoPlayerMethod("play"),c.twitterInterface.callVideoPlayerMethod("mute")},_stopVideo:function(){c.twitterInterface.callVideoPlayerMethod("autoPlayPreviewStop"),c.twitterInterface.callVideoPlayerMethod("pause")},_startDataPolling:function(){c._dataPollingRequestId||(c._dataPollingRequestId=c._cardDataBroker.doRead({"twitter:string:card_uri":c._cardUri},!0))},_stopDataPolling:function(){c._dataPollingRequestId&&(c._cardDataBroker.cancel(c._dataPollingRequestId),c._dataPollingRequestId=null)},_setupDataBroker:function(e){var t={tweetId:e.tweet_id,cardName:e.card_name,uri:e.capi,token:e.token,forward:e.forward,originalData:e.original,refreshInterval:c.refreshRate[c._currentState]};c._cardDataBroker.init(t),c._cardDataBroker.register(c._handleDataUpdate,c._handleDataError)},_handleDataUpdate:function(e,t,r){var n=t.state.toLowerCase();c._updateEventTime(t.start_time,t.current_time),c._currentState!==n&&c._renderState(t)},_handleDataError:function(e,t,r){}};return c}}),r("../native/js/initialize",["require","exports","module","./form-handler","common/video-interface-manager","./flex-embed","./poll_shared/card-poll","./consumer-poll/pollxchoice","./storage/card-storage","./flock/flock2unlock","./promo_convo/convo","./message_me/message_me","./periscope/periscope","./player/player","./utils/emoji-wrap","./live_video/live_video"],function(e,t,r){"use strict";r.exports=function(t){var r={modules:{Interface:t,FormHandler:e("./form-handler"),VideoInterfaceManager:e("common/video-interface-manager"),flexEmbed:e("./flex-embed"),CardPoll:e("./poll_shared/card-poll"),PollXChoice:e("./consumer-poll/pollxchoice"),CardStorage:e("./storage/card-storage"),FlockCard:e("./flock/flock2unlock"),ConvoCard:e("./promo_convo/convo"),MessageMeCard:e("./message_me/message_me"),PeriscopeCard:e("./periscope/periscope"),PlayerCard:e("./player/player"),EmojiWrap:e("./utils/emoji-wrap"),LiveVideoCard:e("./live_video/live_video")},customEvent:{CLDR_LOADED:"cldr_loaded"},serialization:{CARD:"twitter-cards-serialization",JS_BUNDLE:"js-bundle-serialization"},twitterInterface:null,cardStorage:null,cardQueryData:{},CARD_STORAGE_NAMESPACE_PREFIX:"cards_kernel_",isCldrLoaded:!1,init:function(){var e=r._initCard,t=r.getSerialization(r.serialization.CARD),n=r._getQueryData();if(n)try{n=JSON.parse(unescape(n.card_data)),n.tweet_id===t.card.tweet_id&&(r.cardQueryData=n)}catch(o){}if(t)if(t.card)switch(t.card.card_name){case"2485840682:flock":case"2485840682:flock_v2":case"poll2choice_image":case"poll3choice_image":case"poll4choice_image":case"poll2choice_text_only":case"poll3choice_text_only":case"poll4choice_text_only":r._initCardStorage(t.card.card_name,escape(t.card.card_uri)+"_"+t.card.viewer_id,function(){e(t)});break;case"promo_image_convo":case"promo_video_convo":r._initCardStorage(t.card.card_name,"card_id_"+escape(t.card.card_id),function(){e(t)});break;default:e(t)}else e(t)},_initCardStorage:function(e,t,n){r.cardStorage=new r.modules.CardStorage,r.cardStorage.init(r.CARD_STORAGE_NAMESPACE_PREFIX+e,r.CARD_STORAGE_NAMESPACE_PREFIX+t,function(){r._cardInitialized||n()})},_loadScriptAsync:function(e,t){var r=document.createElement("script");document.body.appendChild(r),"function"==typeof t&&r.addEventListener("load",t),r.src=e},_dispatchEvent:function(e){var t=document.createEvent("Event");t.initEvent(e,!0,!0),window.dispatchEvent(t)},_handleCldrLoaded:function(){r.isCldrLoaded=!0,r._dispatchEvent(r.customEvent.CLDR_LOADED)},_handleInitCardWithCldr:function(e){window.addEventListener(r.customEvent.CLDR_LOADED,function(){r._initCard(e)}),r.isCldrLoaded&&r._initCard(e)},getSerialization:function(e){var t,r=document.querySelector('script[type="text/'+e+'"]');try{t=JSON.parse(r.textContent||r.innerHTML)}catch(n){}return t},_getQueryData:function(){var e=window.location.search.substr(1),t={};return e.split("&").forEach(function(e){var r=e.split("=");t[r[0]]=decodeURIComponent(r[1])}),t},_initPlayer:function(e,t,n){r.modules.VideoInterfaceManager.isSupported()&&r.modules.VideoInterfaceManager.init(r.twitterInterface,e,t,n),r.modules.flexEmbed()},_initPlayerPreview:function(){var e=new r.modules.PlayerCard(r.twitterInterface);e.init(r._initPlayer)},_initPoll:function(){var e=new r.modules.CardPoll(r.twitterInterface);e.init()},_initConsumerPoll:function(e){var t=new r.modules.PollXChoice(r.twitterInterface,r.cardStorage);t.init(e,r.cardQueryData)},_initFlock:function(e){var t=new r.modules.FlockCard(r.twitterInterface);t.init(e,r.cardStorage,r._initPlayer)},_initConvo:function(){var e=new r.modules.ConvoCard(r.twitterInterface,r.cardStorage);e.init(r._initPlayer)},_initMessageMe:function(){var e=new r.modules.MessageMeCard(r.twitterInterface);e.init()},_initPeriscope:function(e){var t=new r.modules.PeriscopeCard(r.twitterInterface);t.init(e),r.twitterInterface.attachVideoInterface(t)},_initLiveVideo:function(e){var t=new r.modules.LiveVideoCard(r.twitterInterface);t.init(e,r._initPlayer)},_wrapSummaryContentEmoji:function(){if(/Chrome/.test(navigator.userAgent))for(var e,t,n=r.modules.EmojiWrap,o=document.querySelectorAll(".SummaryCard-content *"),i=0;t=o[i];i++)e=n(t.innerHTML),t.innerHTML!==e&&(t.innerHTML=e)},_loadImagesAsync:function(){for(var e,t,n,o=document.querySelectorAll(".tcu-imageContainer [data-style]"),i=0;e=o[i];i++)t=e.getAttribute("style"),t=t?t+" "+e.getAttribute("data-style"):e.getAttribute("data-style"),e.setAttribute("style","opacity: 0; "+t),n=e.getElementsByTagName("img")[0],n?(n.addEventListener("load",r._showCardImage.bind(e)),n.src=n.getAttribute("data-src"),setTimeout(r._showCardImage.bind(e),2e3)):e.style.opacity=1},_showCardImage:function(){this.style.opacity=1},_initCard:function(e){var t,n=e.card;if(r.twitterInterface=new r.modules.Interface,n&&(t=n.card_name)){switch(t){case"__entity_animated_gif":case"__entity_video":case"amplify":case"animated_gif":r._wrapSummaryContentEmoji(),r._initPlayer();break;case"audio":case"player":r._wrapSummaryContentEmoji(),r._initPlayerPreview();break;case"2485840682:flock":case"2485840682:flock_v2":r._initFlock(e.card.flock);break;case"745291183405076480:live_video":r._wrapSummaryContentEmoji(),r._initLiveVideo(e);break;case"3691233323:periscope_broadcast":r._wrapSummaryContentEmoji(),r._initPlayerPreview(),r._initPeriscope(e);break;case"2427656750:poll_choice2_m":case"2427656750:poll_choice2_r":case"2427656750:poll_choice4_m":case"2427656750:poll_choice4_r":case"2427656750:poll_choice4_rc":case"2427656750:poll_multi_m":case"2427656750:poll_multi_r":r._initPoll();break;case"poll2choice_image":case"poll3choice_image":case"poll4choice_image":case"poll2choice_text_only":case"poll3choice_text_only":case"poll4choice_text_only":r._initConsumerPoll(e);break;case"promotion":new r.modules.FormHandler;break;case"promo_image_convo":case"promo_video_convo":r._initConvo();break;case"2586390716:message_me":r._initMessageMe();break;default:r._wrapSummaryContentEmoji()}r._cardInitialized=!0}}};return r.init(),setTimeout(r._loadImagesAsync,100),r}}),r("common/throttle",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e,t){var r,n,o,i,a=0,c=function(){a=new Date,o=null,i=e.apply(r,n)};return function(){var u=new Date,s=t-(u-a);return r=this,n=arguments,0>=s?(clearTimeout(o),o=null,a=u,i=e.apply(r,n)):o||(o=setTimeout(c,s)),i}}}),r("../native/js/utils/text-ellipsis",["require","exports","module"],function(e,t,r){"use strict";r.exports=function(e){for(var t,r=document.querySelectorAll(e),n=100,o=0;t=r[o];o++){var i=t.offsetHeight+1;if(i>0&&t.scrollHeight>0)for(var a=t.textContent.split(""),c=0;n>c&&(t.scrollHeight>i&&a.length>3);c++)a.splice(a.length-3,3),t.textContent=a.join("")+"..."}}}),r("../native/js/interface",["require","exports","module","delegate","common/throttle","xdm","common/utils","./utils/text-ellipsis"],function(e,t,r){"use strict";var n=e("delegate"),o=e("common/throttle"),i=e("xdm"),a=e("common/utils"),c=e("./utils/text-ellipsis");r.exports=function(e){var t={},r={defaultScribe:{DEFAULT_SCRIBE_ELEMENT:"platform_card"},scribeActionNames:{CARD_CLICK:"card_click",IMPRESSION:"impression",OPEN_AUTH_WEB_VIEW:"open_web_view_card",OPEN_LINK:"open_link",OPEN_PHOTO:"click",SHOW:"show"},selectors:{CARD_CLICK:".js-cardClick",CARD_CONTAINER:".TwitterCardsGrid.TwitterCard",CARD_CONTENT_CONTAINER:".CardContent *:first-child",CARD_ELLIPSIS:".tcu-textEllipse--multiline",CARD_SERIALIZATION:'script[type="text/twitter-cards-serialization"]',OPEN_COMMERCE_COLLECTION:".js-openCommerceCollection",OPEN_PRODUCT_PAGE_CARD:".js-openProductPageCard",COMPOSE_TWEET:".js-statusComposeTweet",OPEN_BUY_NOW_DIALOG:".js-openBuyNowDialog",OPEN_AUTH_WEB_VIEW:".js-openAuthWebView",OPEN_LEADGEN_CONFIRM_DIALOG:".js-openLeadGenConfirmDialog",OPEN_LINK:".js-openLink",OPEN_PHOTO:".js-openPhoto",OPEN_PROFILE:".js-openProfile",OPEN_GALLERY:".js-openGallery",CUSTOM_SCRIBE:".js-cardScribe",OPEN_MESSAGE_ME_DIALOG:".js-openMessageMeDialog"},dataAttrs:{ACTION:"data-action",CARD_BREAKPOINTS:"data-card-breakpoints",CARD_URL:"data-card-url",EARNED:"data-earned",IMPRESSION_ID:"data-impression-id",OPEN_LINK:"data-open-link",P_E_NAME:"data-pe-name",ENGAGEMENT_METADATA:"data-engagement-metadata",SCREEN_NAME:"data-screen-name",TWEET_TEXT:"data-tweet-text",USER_ID:"data-user-id",SCRIBE_ACTION:"data-card-scribe-action",SCRIBE_DATA:"data-card-scribe-data"},RESPONSIVE_STEP_SIZE:50,config:null,host:null,hostMethods:null,throttleHandleResize:null,rpcHelpers:{ready:{onReady:function(){r.host.localMethodNames(function(e){r.hostMethods=e,r.handleOnReady(r.hostMethods)})}},methods:{local:{localMethodNames:function(){return{callVideoPlayerMethod:!0}},callVideoPlayerMethod:function(){r.callVideoPlayerMethod.apply(r,arguments)},transmitEvent:function(e,r,n){e in t&&t[e].forEach(function(e){e.apply(this,[r,n])}.bind(this))}},remote:{callMethodByName:{},followAdvertiser:{},localMethodNames:{},logPromotedInfo:{},openBuyNowDialog:{},openAuthWebView:{},openLeadGenConfirmDialog:{},openLinkNoScribe:{},openPhotoNoScribe:{},openProfile:{},resizeCard:{},scribe:{},statusComposeTweet:{},unfollowAdvertiser:{},subscribeToEvent:{},unsubscribeFromEvent:{},openMessageMeDialog:{}}}},teardown:function(){window.removeEventListener("load",r.handleResize,!1),window.removeEventListener("resize",r.throttleHandleResize,!1),n(document).off("click",r.handleStatusComposeTweet),n(document).off("click",r.handleOpenBuyNowDialog),n(document).off("click",r.handleOpenAuthWebView),n(document).off("click",r.handleOpenLeadGenConfirmDialog),n(document).off("click",r.handleOpenLink),n(document).off("click",r.handleOpenPhoto),n(document).off("click",r.handleOpenProfile),n(document).off("click",r.handleCardClick),n(document).off("click",r.handleOpenCommerceCollection),n(document).off("click",r.handleOpenProductPageCard),n(document).off("click",r.handleOpenMessageMeDialog),r.host.destroy&&r.host.destroy()},handleOnReady:function(e){e&&(e.statusComposeTweet&&n(document).on("click",r.selectors.COMPOSE_TWEET,r.handleStatusComposeTweet),e.openBuyNowDialog&&n(document).on("click",r.selectors.OPEN_BUY_NOW_DIALOG,r.handleOpenBuyNowDialog),e.openAuthWebView&&n(document).on("click",r.selectors.OPEN_AUTH_WEB_VIEW,r.handleOpenAuthWebView),e.openLeadGenConfirmDialog&&n(document).on("click",r.selectors.OPEN_LEADGEN_CONFIRM_DIALOG,r.handleOpenLeadGenConfirmDialog),e.openLinkNoScribe&&n(document).on("click",r.selectors.OPEN_LINK,r.handleOpenLink),e.openPhotoNoScribe&&n(document).on("click",r.selectors.OPEN_PHOTO,r.handleOpenPhoto),e.openProfile&&n(document).on("click",r.selectors.OPEN_PROFILE,r.handleOpenProfile),e.scribe&&(n(document).on("click",r.selectors.OPEN_COMMERCE_COLLECTION,r.handleOpenCommerceCollection),n(document).on("click",r.selectors.OPEN_PRODUCT_PAGE_CARD,r.handleOpenProductPageCard),n(document).on("click",r.selectors.CARD_CLICK,r.handleCardClick),n(document).on("click",r.selectors.CUSTOM_SCRIBE,r.handleCustomScribe)),e.resizeCard&&(r.handleResize(),window.addEventListener("load",r.handleResize,!1),window.addEventListener("resize",r.throttleHandleResize,!1)),e.openMessageMeDialog&&n(document).on("click",r.selectors.OPEN_MESSAGE_ME_DIALOG,r.handleOpenMessageMeDialog),"true"===r.config.card.forward&&r.handleScribe(r.scribeActionNames.SHOW))},handlePromotedEngagement:function(e){r._logPromotedInfo(e,!0)},handleStatusComposeTweet:function(e){r._isSimpleClick(e)&&(r.host.statusComposeTweet({tweetText:e.delegateTarget.getAttribute(r.dataAttrs.TWEET_TEXT),scribeData:r.config.scribeData,impressionId:r._getImpressionId(),earned:"true"===r._getEarned(),engagementMetadata:r._getEngagementMetadata(e.delegateTarget)}),e.preventDefault())},handleOpenBuyNowDialog:function(e){r.host.openBuyNowDialog({tweetId:r.config.card.tweet_id,impressionId:r._getImpressionId(),earned:"true"===r._getEarned(),scribeData:r.config.scribeData}),r._logPromotedInfo(e,!1),r.handleScribe(e.delegateTarget.getAttribute(r.dataAttrs.ACTION)),e.stopPropagation(),e.preventDefault()},handleOpenAuthWebView:function(e){r.host.openAuthWebView({impressionId:r._getImpressionId(),tweetId:r.config.card.tweet_id,webviewUrl:r.config.card.webview_url,webviewTitle:r.config.card.webview_title}),r.handleScribe(r.scribeActionNames.OPEN_AUTH_WEB_VIEW,{description:r.config.card.webview_url}),e.stopPropagation(),e.preventDefault()},handleOpenCommerceCollection:function(e){r._openLink(e,!0);var t={collection_id:r.config.card.collection_id};r._getActionAndScribe(e.delegateTarget,t)},handleOpenProductPageCard:function(e){r._openLink(e,!0),r._getActionAndScribe(e.delegateTarget)},handleOpenLeadGenConfirmDialog:function(e){r.host.openLeadGenConfirmDialog({}),r.handleScribe(r.scribeActionNames.IMPRESSION),e.preventDefault()},handleOpenLink:function(e){var t=e.delegateTarget;r._openLink(e),r._getActionAndScribe(t)},handleOpenPhoto:function(e){var t,n,o,i={photos:[]};if(document.querySelector(r.selectors.OPEN_GALLERY))for(o=document.querySelectorAll(r.selectors.OPEN_PHOTO),t=0;n=o[t];t++)i.photos[t]={imageUrl:n.getAttribute("href"),wasClicked:n===e.delegateTarget};else i.photos.push({imageUrl:e.delegateTarget.getAttribute("href"),wasClicked:!0});i.scribeData=r.config.scribeData,r._isSimpleClick(e)&&(r.host.openPhotoNoScribe(i),r.handleScribe(r.scribeActionNames.OPEN_PHOTO),e.preventDefault())},handleOpenProfile:function(e){r._isSimpleClick(e)&&(r.host.openProfile({userId:e.delegateTarget.getAttribute(r.dataAttrs.USER_ID),userScreenName:e.delegateTarget.getAttribute(r.dataAttrs.SCREEN_NAME),scribeData:r.config.scribeData}),e.preventDefault())},handleCardClick:function(){r.handleScribe(r.scribeActionNames.CARD_CLICK)},handleCustomScribe:function(e){var t,n=e.delegateTarget.getAttribute(r.dataAttrs.SCRIBE_ACTION),o=e.delegateTarget.getAttribute(r.dataAttrs.SCRIBE_DATA);if(n){try{t=JSON.parse(o)||{}}catch(i){t={}}r.handleScribe(n,t)}},handleResize:function(){for(var e=document.querySelector(r.selectors.CARD_CONTAINER),t=document.querySelector(r.selectors.CARD_CONTAINER+" "+r.selectors.CARD_CONTENT_CONTAINER),n=e.offsetWidth,o="",i=Math.floor(n/r.RESPONSIVE_STEP_SIZE);i>0;i--)o+="w"+i*r.RESPONSIVE_STEP_SIZE+" ";t.setAttribute(r.dataAttrs.CARD_BREAKPOINTS,o),c(r.selectors.CARD_ELLIPSIS);var a=e.offsetHeight;r.host&&"function"==typeof r.host.resizeCard&&r.host.resizeCard({height:a+"px"})},_getCardCustomScribeData:function(e){var t;switch(e){case"745291183405076480:live_video":t=r.config.scribeData}return t},handleScribe:function(e,t){var n=r.defaultScribe.DEFAULT_SCRIBE_ELEMENT,e=e,o=r._getCardCustomScribeData(r.config.scribeData.card_name),i=t?a.mergeObjects(t,o):o,c={customScribe:{element:n,action:e,itemData:i},scribeData:r.config.scribeData};this.host.scribe(c)},attachVideoInterface:function(e){r.videoInterface=e},callVideoPlayerMethod:function(){return r.videoInterface?r.videoInterface.callMethodByName.apply(r.videoInterface,arguments):null},destroyVideoPlayer:function(){r.videoInterface&&"function"==typeof r.videoInterface.destroy&&r.videoInterface.destroy(),r.videoInterface=null},callVideoHostMethod:function(){var e=arguments.length;return r.hostMethods&&r.hostMethods.callMethodByName?r.host.callMethodByName.apply(r.host,arguments):void(e>0&&arguments[e-1]())},composeTweet:function(e){r.host.statusComposeTweet(e)},subscribeToEvent:function(e,n){"function"==typeof n&&(e in t?t[e].push(n):t[e]=[n]),r.host.subscribeToEvent({subscribeTo:e})},unsubscribeFromEvent:function(e){t[e]&&(delete t[e],r.host.unsubscribeFromEvent({unsubscribeFrom:e}))},handleOpenMessageMeDialog:function(e){var t={recipientId:r.config.card.recipient_id,defaultComposerText:r.config.card.default_composer_text};"undefined"!=typeof r.config.card.welcome_message_id?t.welcomeMessageId=r.config.card.welcome_message_id:t.tweetId=r.config.card.tweet_id,
r.host.openMessageMeDialog(t),r.handleScribe("click",{card_event:{card_user_data:{binding_values:[{name:"viewing_user_id",value:r.config.card.viewer_id}]}}}),r._logPromotedInfo(e,!1)},handleOpenPeriscopeLink:function(e){r.handleScribe(r.scribeActionNames.OPEN_LINK),r.host.openLinkNoScribe({url:e,scribeData:r.config.scribeData,skipEventUiCardUrlClick:!1})},_logPromotedInfo:function(e,t){var n=e.delegateTarget||e.currentTarget,o=r._getPromotedEventName(n);o&&r.host.logPromotedInfo({event:o,impressionId:r._getImpressionId(),earned:"true"===r._getEarned(),sync:t,scribeData:r.config.scribeData})},_getConfiguration:function(e){var t={},r=document.querySelector(e);if(r)try{t=window.CONFIG=JSON.parse(r.textContent||r.innerText)}catch(n){t.scribeData="error"}else t.scribeData="error";return t},_isSimpleClick:function(e){return!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey||e.which>1)},_getPromotedEventName:function(e){return r._getClosestDataAttribute(e,r.dataAttrs.P_E_NAME)},_getEngagementMetadata:function(e){return r._getClosestDataAttribute(e,r.dataAttrs.ENGAGEMENT_METADATA)},_getImpressionId:function(){return document.querySelector(r.selectors.CARD_CONTAINER).getAttribute(r.dataAttrs.IMPRESSION_ID)},_getEarned:function(){var e=document.querySelector(r.selectors.CARD_CONTAINER).getAttribute(r.dataAttrs.EARNED);return e?e.toLowerCase():void 0},_getClosestDataAttribute:function(e,t){var n;return n=e&&"html"!==e.parentElement.nodeName.toLowerCase()?e.getAttribute(t)||r._getClosestDataAttribute(e.parentElement,t):!1},_openLink:function(e,t){var n=e.delegateTarget,o=r._getClosestDataAttribute(n,r.dataAttrs.OPEN_LINK);"a"!==n.nodeName.toLowerCase()&&o&&window.open(o,"_blank");var i={url:n.getAttribute("href"),scribeData:r.config.scribeData};t&&(i.skipEventUiCardUrlClick=t,r._logPromotedInfo(e,!1)),r.host.openLinkNoScribe(i)},_getActionAndScribe:function(e,t){var n=e.hasAttribute(r.dataAttrs.ACTION)?e.getAttribute(r.dataAttrs.ACTION):r.scribeActionNames.OPEN_LINK;r.handleScribe(n,t)}};r.config=r._getConfiguration(r.selectors.CARD_SERIALIZATION);try{r.host=e||new i.Rpc(r.rpcHelpers.ready,r.rpcHelpers.methods)}catch(u){}return r.throttleHandleResize=o(r.handleResize,75),r}}),e.config({baseUrl:"/lib/js",paths:{delegate:"../bower_components/delegate.js/delegate",matches:"../bower_components/matches.js/matches",xdm:"../bower_components/xdm.js/xdm"}}),t(["../native/js/initialize","../native/js/interface"],function(e,t){e(t)}),r("main-native",function(){})}();